
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>10. Gas Power Cycles - Brayton, Otto and Diesel Cycles &#8212; Thermodynamics with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-Q47V714GTG"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-Q47V714GTG');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-Q47V714GTG');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Gas Power Cycles';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Exercise Solutions" href="Exercise%20Solutions.html" />
    <link rel="prev" title="9. Entropy Change of Real and Idealized Processes" href="Entropy%20Change%20of%20Real%20Processes%20v2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Thermodynamics with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Thermodynamics with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Thermodynamics with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="About.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Brief%20Introduction%20to%20Python.html">2. Brief Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Brief%20Introduction%20to%20Thermodynamics.html">3. Brief Introduction to Thermodynamics: Systems , Processes, States and Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="Evaluation%20of%20Properties.html">4. Evaluation of Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="First%20Law%20of%20Thermodynamics.html">5. First Law of Thermodynamics - Introduction to Closed Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html">6. First Law of Thermodynamics - Boundary Work and Specific Heats</a></li>
<li class="toctree-l1"><a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Open%20Systems.html">7. First Law of Thermodynamics - Open Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html">8. Second Law of Thermodynamics - Directionality of Processes, Entropy, Heat Engines and Refrigerators</a></li>
<li class="toctree-l1"><a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html">9. Entropy Change of Real and Idealized Processes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">10. Gas Power Cycles - Brayton, Otto and Diesel Cycles</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Exercise%20Solutions.html">11. Exercise Solutions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%201.html">11.1. Exercise 1 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%202.html">11.2. Exercise 2 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%203.html">11.3. Exercise 3 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%204.html">11.4. Exercise 4 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%205.html">11.5. Exercise 5 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%206.html">11.6. Exercise 6 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%207.html">11.7. Exercise 7 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise_Solutions/Exercise%208.html">11.8. Exercise 8 Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="References%20Cited.html">12. References Cited</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/Gas Power Cycles.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/Gas Power Cycles.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Gas Power Cycles - Brayton, Otto and Diesel Cycles</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brayton-power-cycle">10.1. Brayton Power Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#idealbrayton">10.1.1. Ideal Brayton Power Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-brayton-cycle">10.1.1.1. Example - Analysis of an Ideal Brayton Cycle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brayton-power-cycle-with-intercooling-reheating-and-regeneration">10.2. Brayton Power Cycle with Intercooling, Reheating and Regeneration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intercooling">10.2.1. Intercooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reheating">10.2.2. Reheating</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regeneration">10.2.3. Regeneration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-intercooling-reheating-and-regeneration-brayton-cycle">10.2.3.1. Example - Analysis of an Intercooling, Reheating and Regeneration Brayton Cycle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closed-system-power-cycles">10.3. Closed-System Power Cycles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otto-cycle">10.3.1. Otto Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-otto-cycle">10.3.1.1. Example - Analysis of an Ideal Otto Cycle</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diesel-cycle">10.3.2. Diesel Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-diesel-cycle">10.3.2.1. Example - Analysis of an Ideal Diesel Cycle</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-example-plotting-analysis-of-an-ideal-diesel-cycle">10.3.2.2. Programming Example - Plotting “Analysis of an Ideal Diesel Cycle”</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stirling-cycle">10.3.3. Stirling Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-stirling-cycle">10.3.3.1. Example - Analysis of an Ideal Stirling Cycle</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ericsson-cycle">10.3.4. Ericsson Cycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">10.3.5. Exercise 8</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="gas-power-cycles-brayton-otto-and-diesel-cycles">
<span id="gaspower"></span><h1><span class="section-number">10. </span>Gas Power Cycles - Brayton, Otto and Diesel Cycles<a class="headerlink" href="#gas-power-cycles-brayton-otto-and-diesel-cycles" title="Link to this heading">#</a></h1>
<p id="index-0">In the last two chapters, the concepts of heat engines (<a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html#heatengine"><span class="std std-numref">Section 8.7</span></a> <a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html#heatengine"><span class="std std-ref">Heat Engines</span></a>), thermal efficiency (<a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html#efficiency"><span class="std std-numref">Section 8.7.1</span></a> <a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html#efficiency"><span class="std std-ref">Heat Engine Thermal Efficiency</span></a>), isentropic efficiency (<a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiency"><span class="std std-numref">Section 9.4</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiency"><span class="std std-ref">Isentropic Efficiency</span></a>) were introduced in a relatively general way. The Carnot heat engine was introduced as the idealized and reversible heat engine with the maximum theoretical efficiency operating between two thermal reservoirs. In this chapter and the next, a variety of operational strategies for real heat engines will be discussed, some based on open system components that produce shaft work with a turbine and some as a series of piston expansion/compression processes.</p>
<p>Heat engines, or power cycles, can be generally categorized as either <a class="reference internal" href="../genindex.html"><span class="std std-ref">gas power cycles</span></a> or vapor power cycles. The distinction between the two is the working fluid. In the case of gas power cycles, the working fluid is a gas, typically air, which does not undergo a change in phase. Vapor power cycles, on the other hand, utilize a working fluid such as H<sub>2</sub>O that undergoes phases change during the cycle. In this chapter the focus is gas power cycles, and next chapter will focus on vapor power cycles.</p>
<p>The gas power cycles to be discussed in this chapter are the Brayton Cycle, Otto Cycle, Diesel Cycle, Striling Cycle and Ericsson Cycles. The former is the gas power cycle that utlizes turbine and compressor technology and is the heart of many power plants and jet engines. The latter are all based on piston cylinder designs where the Otto and Diesel are the main internal combustion engine technologies and the Stirling and Ericcson Cycles integrate heat recuperation for high theoretical efficiencies and are externally heated.</p>
<section id="brayton-power-cycle">
<span id="brayton"></span><h2><span class="section-number">10.1. </span>Brayton Power Cycle<a class="headerlink" href="#brayton-power-cycle" title="Link to this heading">#</a></h2>
<p id="index-1">The <a class="reference internal" href="../genindex.html"><span class="std std-ref">Brayton Power Cycle</span></a> is  at the heart of many power plants and jet engines and utilizes turbomachinery, such as gas turbines and compressors, to perform mechanical shaft work. The real and open-system Brayton power cycle is composed of a compressor, combustor and gas turbine, as seen below in <a class="reference internal" href="#real-brayton"><span class="std std-numref">Figure 10.1</span></a>. Fresh air enters the compressor, is compressed  (process 1-2), combusted at high pressure (process 2-3) with a fuel to produce heat, resulting in combusion products that are expanded in a gas turbine to produce shaft work (process 3-4). The surrounding air serves as a heat sink for the thermal energy disspated from the combusion products. As drawn, this Brayton cycle may be considered an open system when taken as a whole, with fresh air enetering the control volume and combustion products leaving.</p>
<figure class="align-default" id="real-brayton">
<img alt="../_images/realbrayton.png" src="../_images/realbrayton.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.1 </span><span class="caption-text">A schematic of an open and real Brayton Power Cycle. Fresh air is fed to the system, compressed, combusted with a fuel, followed by expansion of the combustion products in a turbine to produce shaft work.</span><a class="headerlink" href="#real-brayton" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="idealbrayton">
<span id="ideal-brayton-power-cycle"></span><h3><span class="section-number">10.1.1. </span>Ideal Brayton Power Cycle<a class="headerlink" href="#idealbrayton" title="Link to this heading">#</a></h3>
<p id="index-2">There are several simplifying assumptions that are typically made to decrease the complexity of the Brayton cycle without sacrificing greatly the accuracy. The first and main assumption is referred to as the <a class="reference internal" href="../genindex.html"><span class="std std-ref">air-standard assumption</span></a>. In this case, the working fluid is approximated as air as an ideal gas that flows in a closed-loop cycle, where it is compressed, heated externally with a high temperature heat exchanger, expanded in a turbine and cooled in a heat exchanger to complete the cycle. Another assumption is that both the compression and expansion processes are reversible and adiabatic (i.e. isentropic). A thired assumption is that the heat addition and rejection in the high and low temperature heat exchangers occurs at constant pressure. And finally, the entire process is assumed to operate at steady state. This <a class="reference internal" href="../genindex.html"><span class="std std-ref">Ideal Brayton Cycle</span></a> is shown below in  <a class="reference internal" href="#ideal-brayton"><span class="std std-numref">Figure 10.2</span></a>. To simplify analysis further, sometimes a <a class="reference internal" href="../genindex.html"><span class="std std-ref">cold-air approximation</span></a> may be used which assumes constant specific heats, both <em>c</em><sub>p</sub> and <em>c</em><sub>v</sub> of air at ambient conditions, and all prior equations that assume constant specific heats may be applied, such as those from <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a>. Finally, real turbines and compressors may be analyzed within the framework of this cycle by accounting for their isentropic efficiencies, as discussed in <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiency"><span class="std std-numref">Section 9.4</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiency"><span class="std std-ref">Isentropic Efficiency</span></a>.</p>
<figure class="align-default" id="ideal-brayton">
<img alt="../_images/idealbrayton.png" src="../_images/idealbrayton.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.2 </span><span class="caption-text">An example of a closed and ideal Brayton Cycle. Air is circulated in a closed loop, where it is first compressed isentropically, heated at constant pressure in a heat exchanger, expanded isentropically to produce shaft work, and finally cooled at constant pressure in a low temperature heat exchanger.</span><a class="headerlink" href="#ideal-brayton" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>With an appropriate system boundary around every component, this can be treated as a closed system, and analyzed with the closed system energy balance equation, in rate form, discussed in <a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-numref">Section 5.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-ref">Energy Transfer and The First Law</span></a>.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa1">
<span class="eqno">(10.1)<a class="headerlink" href="#equation-eq-aa1" title="Link to this equation">#</a></span>\[\frac{dU}{dt} = \dot Q_{\rm net} - \dot W_{\rm net}\]</div>
<p>Because the process operates at steady state, <span class="math notranslate nohighlight">\(\frac{dU}{dt} = 0\)</span>, and</p>
<div class="math notranslate nohighlight" id="equation-eq-aa2">
<span class="eqno">(10.2)<a class="headerlink" href="#equation-eq-aa2" title="Link to this equation">#</a></span>\[\dot Q_{\rm H}+\dot Q_{\rm L}=\dot W_{\rm 12}+\dot W_{\rm 34}\]</div>
<p>The thermal efficiency is then</p>
<div class="math notranslate nohighlight" id="equation-eq-aa3">
<span class="eqno">(10.3)<a class="headerlink" href="#equation-eq-aa3" title="Link to this equation">#</a></span>\[\eta_{\rm th} = \frac{\dot W_{\rm net}}{\dot Q_{\rm H}} = 1- \frac{\dot Q_{\rm L}}{\dot Q_{\rm H}}\]</div>
<p>When an appropriate boundary is drawn around a component of interest within the cycle, it should be analyzed with the steady state open system energy balance discussed in <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Open%20Systems.html#firstlawopen"><span class="std std-numref">Section 7</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Open%20Systems.html#firstlawopen"><span class="std std-ref">First Law of Thermodynamics - Open Systems</span></a>. Using this form of the energy equation enables determination of either desired heat transfer rates and work terms, or it can be used to evaluate appropriate state properties at the inlets or exits. For example, taking the turbine as the control volume and assuming steady state, adiabatic, negligible change in kinetic and potential energies, the energy equation becomes the following.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa4">
<span class="eqno">(10.4)<a class="headerlink" href="#equation-eq-aa4" title="Link to this equation">#</a></span>\[\dot W_{\rm 34} = \dot m_{\rm air} (h_{\rm i}-h_{\rm e})\]</div>
<p>Recognizing that state 3 is the inlet and state 4 is the exit it can also be written as below.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa5">
<span class="eqno">(10.5)<a class="headerlink" href="#equation-eq-aa5" title="Link to this equation">#</a></span>\[\dot W_{\rm 34} = \dot m_{\rm air} (h_{\rm 3}-h_{\rm 4})\]</div>
<p>And if specific heats are used, then either average specific heat or using cold-air approximation may be used, understanding the assumptions inherent to each approach.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa6">
<span class="eqno">(10.6)<a class="headerlink" href="#equation-eq-aa6" title="Link to this equation">#</a></span>\[\dot W_{\rm 34} = c_{\rm p} (T_{\rm 3}-T_{\rm 4})\]</div>
<p>Note that if average values for specific heats are used and one of the temperatures are not known, then an iterative, or guess and check solution approach would be required. Refer to <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiencyexample2"><span class="std std-numref">Section 9.4.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicefficiencyexample2"><span class="std std-ref">Example - Isentropic Efficiency Iterative Solution Approach</span></a> as an example.</p>
<section id="example-analysis-of-an-ideal-brayton-cycle">
<h4><span class="section-number">10.1.1.1. </span>Example - Analysis of an Ideal Brayton Cycle<a class="headerlink" href="#example-analysis-of-an-ideal-brayton-cycle" title="Link to this heading">#</a></h4>
<p>In a Brayton cycle, air enters the compressor at 0.1 MPa and 298 K. The pressure leaving the compressor is 1.0 MPa and the maximum temperature is 1240 K. Assume an isentropic efficiency of 80% for the compressor and 85% for the turbine. Determine the compressor specific work, turbine specific work and cycle efficiency. Use property values from Cantera (i.e. variable specific heats) rather than constant specific heat equations. Understand how to solve using constant specific heat equations.</p>
<blockquote>
<div><p><strong>Solution</strong> There are only two pressures in this simple Brayton cycle, and thus all pressures are known. The maximum temperature occurs after external heat addition, and therefore the only properties not given are the temperatures following compression and expansion. We can use the provided isentropic efficiencies to determine enthalpies at each of these states. For this we will need to recognize that the entropy at the inlet and exit of the compressor and turbine are equal in the isentropic case.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>
<span class="c1">#we have 6 total states including the isentropic states, thus we will set each of these to be air</span>

<span class="n">state1</span><span class="p">,</span><span class="n">state2s</span><span class="p">,</span><span class="n">state2</span><span class="p">,</span><span class="n">state3</span><span class="p">,</span><span class="n">state4s</span><span class="p">,</span><span class="n">state4</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">),</span><span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">),</span><span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">),</span><span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">),</span><span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">),</span><span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state1</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">state2s</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">state2</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">state3</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">state4s</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">state4</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span><span class="p">,</span><span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span><span class="p">,</span><span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span><span class="p">,</span><span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span><span class="p">,</span><span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span><span class="p">,</span><span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>

<span class="c1">#given or inferred properties</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span> <span class="c1">#Pa</span>
<span class="n">p4</span><span class="o">=</span><span class="n">p1</span> <span class="c1">#constant pressure heat rejection</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">298</span> <span class="c1">#K</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span> <span class="c1">#Pa</span>
<span class="n">p3</span><span class="o">=</span><span class="n">p2</span> <span class="c1">#constant pressure heat addition</span>
<span class="n">T3</span> <span class="o">=</span> <span class="mi">1240</span> <span class="c1">#K</span>
<span class="n">eta_comp</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">eta_turb</span> <span class="o">=</span> <span class="mf">0.85</span>

<span class="c1">#determine s1 and equate to s2s</span>
<span class="n">state1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T1</span><span class="p">,</span><span class="n">p1</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">state1</span><span class="o">.</span><span class="n">SP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s2s</span><span class="o">=</span><span class="n">s1</span>
<span class="c1">#also we can get h1</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">state1</span><span class="o">.</span><span class="n">HP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#knowing s2s and p2, determine h2s</span>
<span class="n">state2s</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">s2s</span><span class="p">,</span><span class="n">p2</span>
<span class="n">h2s</span> <span class="o">=</span> <span class="n">state2s</span><span class="o">.</span><span class="n">HP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#solve for h2 using isentropic efficiency of the compressor</span>
<span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">h2s</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span><span class="o">/</span><span class="n">eta_comp</span><span class="o">+</span><span class="n">h1</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;specific enthalpies at states 1 and 2 are &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>specific enthalpies at states 1 and 2 are  -112.33 and 348170.44 kJ kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#determine s3 and equate to s4s</span>
<span class="n">state3</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T3</span><span class="p">,</span><span class="n">p3</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">state3</span><span class="o">.</span><span class="n">SP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s4s</span><span class="o">=</span><span class="n">s3</span>
<span class="c1">#also we can get h3</span>
<span class="n">h3</span> <span class="o">=</span> <span class="n">state3</span><span class="o">.</span><span class="n">HP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#knowing s4s and p4, determine h4s</span>
<span class="n">state4s</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">s4s</span><span class="p">,</span><span class="n">p4</span>
<span class="n">h4s</span> <span class="o">=</span> <span class="n">state4s</span><span class="o">.</span><span class="n">HP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#solve for h4 using isentropic efficiency of the turbine</span>
<span class="n">h4</span> <span class="o">=</span> <span class="n">h3</span><span class="o">-</span><span class="p">(</span><span class="n">h3</span><span class="o">-</span><span class="n">h4s</span><span class="p">)</span><span class="o">*</span><span class="n">eta_comp</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;specific enthalpies at states 3 and 4 are &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">h3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">h4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;J kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>specific enthalpies at states 3 and 4 are  1034042.51 and 533284.7 J kg-1
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Now it is a matter of performing energy balances for the compressor, turbine and high temperature heat exchanger. Assuming steady state operation, adiabatic, negligable kinetic and potential energies, the open system energy conservation equation reduces to the follwoing specific work terms for each.</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( w_{\rm 12} = (h_{\rm 1}-h_{\rm 2})\)</span></p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( w_{\rm 34} = (h_{\rm 3}-h_{\rm 4})\)</span></p>
</div></blockquote>
<blockquote>
<div><p>Assuming steady state operation, constant pressure, negligable kinetic and potential energies, the open system energy conservation equation reduces to the following specific heat transfer term.</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( q_{\rm 23} = (h_{\rm 3}-h_{\rm 2})\)</span></p>
</div></blockquote>
<blockquote>
<div><p>Each of the specific enthalpy terms has already been determined, so we can solve for each directly.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_comp</span> <span class="o">=</span> <span class="n">h1</span><span class="o">-</span><span class="n">h2</span>
<span class="n">w_turb</span> <span class="o">=</span> <span class="n">h3</span><span class="o">-</span><span class="n">h4</span>
<span class="n">q_23</span> <span class="o">=</span> <span class="n">h3</span><span class="o">-</span><span class="n">h2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;specific compressor work is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">w_comp</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;specific turbine work is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">w_turb</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;specific heat transfer is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">q_23</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>specific compressor work is -348.28 kJ kg-1
specific turbine work is 500.76 kJ kg-1
specific heat transfer is 685.87 kJ kg-1
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Understanding that the thermal efficiency is the net work divided by the heat addition it can be solved directly.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta_th</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_comp</span><span class="o">+</span><span class="n">w_turb</span><span class="p">)</span><span class="o">/</span><span class="n">q_23</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency of the Brayton cycle is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta_th</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The thermal efficiency of the Brayton cycle is 22.23 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="brayton-power-cycle-with-intercooling-reheating-and-regeneration">
<span id="brayton2"></span><h2><span class="section-number">10.2. </span>Brayton Power Cycle with Intercooling, Reheating and Regeneration<a class="headerlink" href="#brayton-power-cycle-with-intercooling-reheating-and-regeneration" title="Link to this heading">#</a></h2>
<p id="index-3">There are several strategies empolyed to increase the efficiency of the idealized Brayton cycle. These include integrating <a class="reference internal" href="../genindex.html"><span class="std std-ref">intercooling</span></a>, <a class="reference internal" href="../genindex.html"><span class="std std-ref">reheating</span></a> and <a class="reference internal" href="../genindex.html"><span class="std std-ref">regeneration</span></a> strategies. These strategies serve to 1) decrease compression work by integrating cooling during compression, 2) increase turbine work by integrating heat addition during expansion and 3) decrease the amount of external heat transfer required to the system by recuperating heat internally between the exits of the turbine and compressors.</p>
<section id="intercooling">
<span id="id1"></span><h3><span class="section-number">10.2.1. </span>Intercooling<a class="headerlink" href="#intercooling" title="Link to this heading">#</a></h3>
<p id="index-4">Last chapter in the section on reversible work, <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#reversiblework"><span class="std std-numref">Section 9.3</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#reversiblework"><span class="std std-ref">Reversible Steady State Work</span></a>,  we saw that isentropic compression/expansion does not result in the minimum/maximum shaft work associated with compressors and turbines. Instead, it was shown that isothermal compression and isothermal expansion enable the minimum/maximum work. Thus, compression should be integrated with cooling and expansion with heating, both of which minimuze/maximize volume-pressure relationship correlated with reversible shaft work, shown again below for reference.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa7">
<span class="eqno">(10.7)<a class="headerlink" href="#equation-eq-aa7" title="Link to this equation">#</a></span>\[w_{\rm rev} =  - \int_{1}^{2} vdp\]</div>
<p>In practice, rather than simultaneously cooling during comprssion, <a class="reference internal" href="../genindex.html"><span class="std std-ref">intercoolers</span></a> are utilized between stages of adiabatic compression to intermittantly cool the compresssed gas. The intercooler is simply a gas heat exchanger that rejects heat from the compressed gas at constant pressure. In theory, given a large enough number of compression, intercooling stages, the compression process would approximiate an isothermal process and approach the theoretical minimum work limit. However, for practical considerations, usually no more than a few intercoolers are integrated with the compression process, and there are diminishing returns for each additional intercooler integrated. A schematic of an intercooler integrated between two stages of adiabatic compression, alongside the corresponsing T-s diagram, are shown below in <a class="reference internal" href="#intercooler"><span class="std std-numref">Figure 10.3</span></a>. As seen, the first compression stage to an intermediate pressure increases temperature and specific volume (not shown). Cooling the gas in an intercooler back to a lower temperature (usually the same as state 1), enables compression to the final pressure at smaller specific volumes compared to the compression process without intercooling, thus reducing  <span class="math notranslate nohighlight">\(w_{\rm rev} =  - \int vdp\)</span>. Also, note that the final temperature is equal to the intermediate temperature(<em>T</em><sub>4</sub> = <em>T</em><sub>2</sub>) and is lower than it would be when compared to the compression process without intercooling (<em>T</em><sub>4</sub> &gt; <em>T</em><sub>2</sub>), thus better approximating an isothermal compression process.</p>
<figure class="align-default" id="intercooler">
<img alt="../_images/intercooler.png" src="../_images/intercooler.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.3 </span><span class="caption-text">An intercooler integrated between two stages of adiabatic compression. The intercooler rejects heat from the compressed gas, thereby reducing the amount of compression work required to operate between two pressures.</span><a class="headerlink" href="#intercooler" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="reheating">
<span id="id2"></span><h3><span class="section-number">10.2.2. </span>Reheating<a class="headerlink" href="#reheating" title="Link to this heading">#</a></h3>
<p id="index-5">Similar to intercooling, <a class="reference internal" href="../genindex.html"><span class="std std-ref">reheaters</span></a> are integrated bewteen stages of adiabatic expansion to approximate isothermal expansion, rather than heating simultaneously during gas expansion. Reheaters are simply gas heat exchangers that supply heat at constant pressure. A schematic of a reheater integrated between two stages of adiabatic expansion, alongside the corresponsing T-s diagram, are shown below in <a class="reference internal" href="#reheater"><span class="std std-numref">Figure 10.4</span></a>. As seen, the first expansion stage to an intermediate pressure decreases temperature and specific volume (not shown). Reheating the gas in a reheater back to a higher temperature (usually the same as state 1), enables expansion to the final pressure at larger specific volumes compared to the expansion process without reheating, thus increasing <span class="math notranslate nohighlight">\(w_{\rm rev} =  \int vdp\)</span>. Also, note that the final temperature is equal to the intermediate temperature(T4 = T2) and is higher than it would be when compared to the compression process without reheating (<em>T</em><sub>4</sub>  &lt; <em>T</em><sub>2</sub>), thus better approximating an isothermal expansion process.</p>
<figure class="align-default" id="reheater">
<img alt="../_images/reheater.png" src="../_images/reheater.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.4 </span><span class="caption-text">A reheater integrated between two stages of adiabatic expansion. The reheater supplies heat to the gas at intermediate pressure, thereby increasing the amount of expansion work extracted between high and low pressures.</span><a class="headerlink" href="#reheater" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>An idealized Brayton cycle with intercooling and reheating is shown below in <a class="reference internal" href="#intercooler-reheater"><span class="std std-numref">Figure 10.5</span></a>, alongside a corresponding T-s diagram. As seen, there are three total pressures in this configuration, because intercooling and reheating are typically performed at the same intermediate pressure. The gray dashed line is included only for visualization purposes.</p>
<figure class="align-default" id="intercooler-reheater">
<img alt="../_images/intercoolreheat.png" src="../_images/intercoolreheat.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.5 </span><span class="caption-text">A Brayton cycle with both intercooling and reheating. There are three unique pressures in the cycle because typically intercooling and reheating are performed at the same intermediate pressure.</span><a class="headerlink" href="#intercooler-reheater" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="regeneration">
<span id="id3"></span><h3><span class="section-number">10.2.3. </span>Regeneration<a class="headerlink" href="#regeneration" title="Link to this heading">#</a></h3>
<p id="index-6">As seen in <a class="reference internal" href="#intercooler-reheater"><span class="std std-numref">Figure 10.5</span></a>, the temperature leaving the low pressure turbine prior to heat rejection (state 8), is greater than the temperature leaving the high pressure compressor prior to external heat addition (state 4). This presents an opportunity to integrate internal heat recupertation between these two different temperature streams, in order to reduce the external heat addition requirement and thus boost efficiency. The heat exchanger responsible for this internal heat recuperation is called a <a class="reference internal" href="../genindex.html"><span class="std std-ref">regenerator</span></a>. An example of a Brayton cycle incorporating an intercooler, reheater and regenerator is shown below in <a class="reference internal" href="#regenerator"><span class="std std-numref">Figure 10.6</span></a>. The regenerator is a counterflow heat exchanger that operates at constant pressure and is designed to transfer the relatively high temperature heat leaving the low pressure turbine to the exit of the high temperature compressor.</p>
<figure class="align-default" id="regenerator">
<img alt="../_images/regenerator.png" src="../_images/regenerator.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.6 </span><span class="caption-text">A Brayton cycle with both intercooling, reheating and regeneration. There are three unique pressures in the cycle because typically intercooling and reheating are performed at the same intermediate pressure. The maximim temperature leaving the cold stream is the temperature entering on the hot side, at state 8.</span><a class="headerlink" href="#regenerator" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The resulting state following heat addition to the cold temperature side is labled state a, and from the high temperature side, state b. As seen, because both the hot and cold gases in the heat exchanger exchange heat at constant pressure, there is no change in the T-s diagram compared to a process without the regenerator, with the exception of the added states a and b.  The regenerator may be analyzed as an open system and adiabatic heat exchanger with two inlets and two exits operating at steady state. Ignoring changes in kinetic and potential energies of the fluids and disregarding any work terms, the energy conservation equation reduces to the form below.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa8">
<span class="eqno">(10.8)<a class="headerlink" href="#equation-eq-aa8" title="Link to this equation">#</a></span>\[0 =  h_{\rm 8} + h_{\rm 4} - h_{\rm b} - h_{\rm a}\]</div>
<p>Thus, the change in enthalpy of the hot stream leaving the turbine is equal to the enthalpy gain in the cold stream.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa9">
<span class="eqno">(10.9)<a class="headerlink" href="#equation-eq-aa9" title="Link to this equation">#</a></span>\[h_{\rm 8} - h_{\rm b} = h_{\rm a} -  h_{\rm 4}\]</div>
<p>The enthalpy change of each stream is also the amount of heat internally recuperated, <span class="math notranslate nohighlight">\(\dot Q_{\rm int}\)</span>. This amount of heat recuperation directly reduces the amount of external heat required to heat to the inlet temperature of the high pressure turbine, state 5, which in specific temrms is equal to <span class="math notranslate nohighlight">\(h_{\rm 5}-h_{\rm a}\)</span>.</p>
<p id="index-7">To determine state properties exiting the regenerator, it is not sufficient to only apply an open system energy balance around the heat exchanger because both temperatures are usually unknown. To resolve this, the  of the heat exchanger is required. Effectivness (<span class="math notranslate nohighlight">\(\epsilon_{\rm reg}\)</span>), or <a class="reference internal" href="../genindex.html"><span class="std std-ref">heat exchanger effectiveness factor</span></a>, is a measure of the real heat exchanger performance relative to the maximum possible, and. The maximum possible performance is determined by recognizing that the maximum temperature that the cold fluid could be heated to is the the exit temperature of the low pressure turbine at state 8. This can be imagined by a counterflow heat exchanger where there is an infintesimally small temperature difference between hot and cold streams at each position within the heat exchanger. If it were any higher then this would violate the second law of thermodynamics because heat cannot be transferred from low to high temperature spontaneously. Mathematically, <span class="math notranslate nohighlight">\(\epsilon_{\rm reg}\)</span> is described as below and is always a value between 0 and 1.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa10">
<span class="eqno">(10.10)<a class="headerlink" href="#equation-eq-aa10" title="Link to this equation">#</a></span>\[\epsilon_{\rm reg} = \frac{T_{\rm a} -  T_{\rm 4}}{T_{\rm a,max} -  T_{\rm 4}}=\frac{T_{\rm a} -  T_{\rm 4}}{T_{\rm 8} -  T_{\rm 4}}\]</div>
<section id="example-analysis-of-an-intercooling-reheating-and-regeneration-brayton-cycle">
<h4><span class="section-number">10.2.3.1. </span>Example - Analysis of an Intercooling, Reheating and Regeneration Brayton Cycle<a class="headerlink" href="#example-analysis-of-an-intercooling-reheating-and-regeneration-brayton-cycle" title="Link to this heading">#</a></h4>
<p>Consider an ideal gas turbine cycle using air with two stages of isentropic compression and two stages of isentropic expansion. The pressure ratio across each compressor and turbine is 8. Pressure entering the first compressor is 100 kPa, the temperature entering each compressor is 20 °C, and the temperature entering each turbine is 1100 °C. A regenerator is also incorporated with an efficiency of 70%. Determine the specific compressor power input, the specific power output from the turbine and the overall thermal efficiency. Use constant specific heats at &#64; 300 K – understand how to solve without using specific heats.</p>
<blockquote>
<div><p><strong>Solution</strong> For this problem we can take advantage of the isentropic equations to evaluate the compressors and turbines, introduced in <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a>. We can use these because we are assuming constant specific heats. Since we know inlet and exit temperatures and pressure ratios the form <span class="math notranslate nohighlight">\(\frac{T_2}{T_1} = (\frac{p_2}{p_1})^{\frac{k-1}{k}}\)</span> will be most useful.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>

<span class="c1"># first, lets determine k and cp for air at 300 K. We will use 1 bar pressure</span>
<span class="c1">#but since air is an ideal gas where specific heats are functions of tmeperature only</span>
<span class="c1">#our choice of pressure is irrelevant</span>

<span class="n">state1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state1</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">state1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># K,Pa</span>
<span class="n">cp</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cp</span>
<span class="n">cv</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cv</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">cv</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cp is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1 K-1 and k is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cp is 1010.07 kJ kg-1 K-1 and k is 1.4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># below is the information given in the problem statement</span>

<span class="n">p_ratio</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">+</span><span class="mf">273.15</span> <span class="c1">#K</span>
<span class="n">T3</span><span class="o">=</span><span class="n">T1</span>
<span class="n">T5</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">+</span><span class="mf">273.15</span> <span class="c1">#K</span>
<span class="n">T7</span> <span class="o">=</span> <span class="n">T5</span>
<span class="n">eta_reg</span> <span class="o">=</span> <span class="mf">0.7</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># analyzing the first compressor we can solve for the exit temperature</span>

<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">*</span><span class="n">p_ratio</span><span class="o">**</span><span class="p">((</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>

<span class="c1"># since the pressure ratio is the same and air is cooled back to 20 C, T4 must be equivilent to T2</span>

<span class="n">T4</span><span class="o">=</span><span class="n">T2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The compressor exit temperatures are both&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The compressor exit temperatures are both 530.59 K
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># analyzing the first turbine we can solve for the exit temperature</span>

<span class="n">T6</span> <span class="o">=</span> <span class="n">T5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">p_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>

<span class="c1"># since the pressure ratio is the same and air is heated back to 1100 C, T8 must be equivilent to T6</span>

<span class="n">T8</span><span class="o">=</span><span class="n">T6</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The turbine exit temperatures are both&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T6</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The turbine exit temperatures are both 758.67 K
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># analyzing the regenerator, the max temperature exiting the cold stream is T8</span>

<span class="n">Tmax</span> <span class="o">=</span> <span class="n">T8</span>
<span class="n">Ta</span> <span class="o">=</span> <span class="n">T4</span><span class="o">+</span><span class="n">eta_reg</span><span class="o">*</span><span class="p">(</span><span class="n">Tmax</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The regenerator exit temperatures on the cold side is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The regenerator exit temperatures on the cold side is 690.24 K
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># specific compressor power input</span>

<span class="n">w_12</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span>
<span class="n">w_34</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T3</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span>
<span class="n">w_comp</span> <span class="o">=</span> <span class="n">w_12</span><span class="o">+</span><span class="n">w_34</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The compressor specific work input is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">w_comp</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The compressor specific work input is -479656.17 kJ kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># specific turbine power output</span>

<span class="n">w_56</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T5</span><span class="o">-</span><span class="n">T6</span><span class="p">)</span>
<span class="n">w_78</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T7</span><span class="o">-</span><span class="n">T8</span><span class="p">)</span>
<span class="n">w_turb</span> <span class="o">=</span> <span class="n">w_56</span><span class="o">+</span><span class="n">w_78</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The turbine specific work output is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">w_turb</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The turbine specific work output is 1241340.91 kJ kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To determine efficiency we need to know the external heat addition, heating from </span>
<span class="c1"># state a to state 5 and from state 6 to state 7</span>

<span class="n">q_a5</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T5</span><span class="o">-</span><span class="n">Ta</span><span class="p">)</span>
<span class="n">q_67</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T7</span><span class="o">-</span><span class="n">T6</span><span class="p">)</span>
<span class="n">q_in</span> <span class="o">=</span> <span class="n">q_a5</span><span class="o">+</span><span class="n">q_67</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The specific heat input is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">q_in</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The specific heat input is 1310453.58 kJ kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And using the definition of thermal efficiency we can calculate it directly</span>

<span class="n">eta_th</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_comp</span><span class="o">+</span><span class="n">w_turb</span><span class="p">)</span><span class="o">/</span><span class="n">q_in</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta_th</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The thermal efficiency is 58.12 %
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Note how much higher this efficiency is compared to the prior example that didn’t incorporate intercooling, reheating and regeneration. We can also see how the efficiency would compare if we were to remove the regenerator by re-calculating the external heat addition from state 4 to 5 and 6 to 7.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_45</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T5</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span>
<span class="n">q_67</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T7</span><span class="o">-</span><span class="n">T6</span><span class="p">)</span>
<span class="n">q_in</span> <span class="o">=</span> <span class="n">q_45</span><span class="o">+</span><span class="n">q_67</span>
<span class="n">eta_th</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_comp</span><span class="o">+</span><span class="n">w_turb</span><span class="p">)</span><span class="o">/</span><span class="n">q_in</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency without regeneration is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta_th</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The thermal efficiency without regeneration is 51.75 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="closed-system-power-cycles">
<h2><span class="section-number">10.3. </span>Closed-System Power Cycles<a class="headerlink" href="#closed-system-power-cycles" title="Link to this heading">#</a></h2>
<p id="index-8">Several gas power cycles  can be modeled as a series of piston-cylinder expansion/compression processes. Like with the Brayton cycle, air-standard assumptions are often utilized and used exclusively here, rather than accounting for variation in gas species due to combusion processes. These cycles include internal combustion engines, namely the <a class="reference internal" href="../genindex.html"><span class="std std-ref">Otto</span></a> and <a class="reference internal" href="../genindex.html"><span class="std std-ref">Diesel</span></a> cycles, and external combusion engines that incorporate internal heat recuperation to improve efficiency, namely the <a class="reference internal" href="../genindex.html"><span class="std std-ref">Stirling</span></a> and <a class="reference internal" href="../genindex.html"><span class="std std-ref">Ericcson</span></a> cycles.</p>
<section id="otto-cycle">
<h3><span class="section-number">10.3.1. </span>Otto Cycle<a class="headerlink" href="#otto-cycle" title="Link to this heading">#</a></h3>
<p id="index-9">The <a class="reference internal" href="../genindex.html"><span class="std std-ref">Otto cycle</span></a>, also known as the ideal cycle for spark ignition engines, is typically composed of four complete strokes of a piston within a cylinder. The first two are related to compression and expansion and are closely related to the net work output, whereas the last two are necessary to exhaust combustion products and intake fresh air. The complete analysis, taking into account all four strokes and variation in gas composition, is beyond the scope of this textbook. Nevertheless, a brief explanation and description of the real process is presented. The first stroke consists of compression of air-fuel mixture to a pressure below the auto ignition point, to prevent spontaneous and uncontrolled combustion. This is referred to as the compression stroke. Once sufficiently compressed, the combustion reaction is initiated with a spark (i.e. spark plug), generating heat and increasing pressure. The resulting high pressure combustion gases force the piston down to complte the second stroke, producing useful work output. This is referred to as the power, or expansion stroke. This is followed by an exhaust stroke (third stroke) responsible for removing combustion products through an exhaust valve which are slightly higher than ambient pressure, and finally by an intake stroke (fourth stroke) where fresh air is introduced through an intake valve at slightly less than ambient pressure. Becuase combustion occurs within the piston-cyclinder, the Otto cycle is a type of internal combusion engine.</p>
<p>This four stroke process is greatly simplified using air-standard assumptions. Using air-standard assumptions, the Ideal Otto cycle consists of four internally reversible processes and two piston strokes. Because air standard assumptions are used, the heat transfer occurs from/to and external reservoir. The four processes can be summarized as:</p>
<ol class="arabic simple">
<li><p>Isentropic compression</p></li>
<li><p>Constant volume heat addition from an external source</p></li>
<li><p>Isentropic expansion</p></li>
<li><p>Constant volume heat rejection</p></li>
</ol>
<p>A piston-cylinder representation of the air-standard Ideal Otto Cycle is shown below in <a class="reference internal" href="#otto"><span class="std std-numref">Figure 10.7</span></a>. Starting on the left at state 1, compression work (<span class="math notranslate nohighlight">\(W_{\rm 12}\)</span>) is done to the piston to move it from the bottom dead volume (BDV) to top dead volume (TDV) isentropically. Then, heat is added (<span class="math notranslate nohighlight">\(Q_{\rm 23}\)</span>) from an external source while the piston-cylinder volume remains constant. This results in an increase in temperature and pressure. Following heat addition, the piston expands back to BDV, doing work to the surroundings (<span class="math notranslate nohighlight">\(W_{\rm 34}\)</span>), resulting in a temperature decrease of the air. Finally, the air is further cooled by rejecting heat at constant volume to an external source, going from state 4 to state 1. Notice from the figure that there are only two different volumes throughout the cycle. Also, because both work processes are isentropic, their are only two unique entropies in the cycle. Because heat addition occurs while the volume is held constant, there is by definition no boundary work corresponding to processes 2-3 and 4-1. And because the expansion and compression processes are isentropic and reversible, they must be adiabatic. Thus, there is no heat transfer associated with processes 1-2 and 3-4.</p>
<figure class="align-default" id="otto">
<img alt="../_images/otto.png" src="../_images/otto.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.7 </span><span class="caption-text">An Ideal Otto Cycle, composed of two piston strokes and 4 unique states.</span><a class="headerlink" href="#otto" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It is useful to visualize the Otto Cycle using both a <em>T-s</em> and <em>p-v</em> disgram to understand where all of the work and heat transfer processes are occuring. These are shown below in <a class="reference internal" href="#otto-chart"><span class="std std-numref">Figure 10.8</span></a>. Going from state 1 to state 2, notice on the <em>T-s</em> diagram that the isentropic work process consists of a vertical line increasing in temperature, whereas on the <em>p-v</em> diagram the volume decreases from BDC to TDC. As heat is added during process 2-3, temperature increases as would be expected keeping volume constant, and notice on the <em>p-v</em> diagram this results in a vertial line corresponding to an increase in pressure. Expansion during process 3-4 is isentropic, corresponding to a vertical line decreasing in temperature as seen on the <em>T-s</em> diagram and increase in volume and corresponding decrease in pressure as seen on the <em>p-v</em> diagram. Finally, as heat is rejected, both temperature and entropy decrease, as well as pressure.</p>
<figure class="align-default" id="otto-chart">
<img alt="../_images/otto_chart.png" src="../_images/otto_chart.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.8 </span><span class="caption-text"><em>T-s</em> and <em>p-v</em> diagrams for the Ideal Otto Cycle, indicating all relevent heat transfer and work terms, as well as isentropic and isochoric processes.</span><a class="headerlink" href="#otto-chart" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Analysis of each of the processes within the Ideal Otto cycle may be performed using the closed system energy conservation equation (<a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-numref">Section 5.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-ref">Energy Transfer and The First Law</span></a>), ideal gas law (<a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-numref">Section 4.2</span></a> <a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-ref">Ideal Gas Equation of State</span></a>), and when applicable the isentropic ideal gas equations from (<a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a>). Starting from the closed system energy conservation equation (<span class="math notranslate nohighlight">\(\Delta U = 0 = Q_{\rm net} - W_{\rm net}\)</span>) for each process, the following equations can be derived.</p>
<p>Process 1-2: <span class="math notranslate nohighlight">\(\Delta U_{\rm 1-2} = Q_{\rm 1-2} - W_{\rm 1-2}\)</span>, where <span class="math notranslate nohighlight">\(Q_{\rm 1-2} = 0\)</span></p>
<blockquote>
<div><p>thus <span class="math notranslate nohighlight">\(W_{\rm 1-2} = U_{\rm 1} - U_{\rm 2} = m(u_{\rm 1} - u_{\rm 2}) =  mc_{\rm v}(T_{\rm 1} - T_{\rm 2})\)</span></p>
</div></blockquote>
<p>Process 2-3: <span class="math notranslate nohighlight">\(\Delta U_{\rm 2-3} = Q_{\rm 2-3} - W_{\rm 2-3}\)</span>, where <span class="math notranslate nohighlight">\(W_{\rm 2-3} = 0\)</span></p>
<blockquote>
<div><p>thus <span class="math notranslate nohighlight">\(Q_{\rm 2-3} = U_{\rm 3} - U_{\rm 2} = m(u_{\rm 3} - u_{\rm 2}) =  mc_{\rm v}(T_{\rm 3} - T_{\rm 2})\)</span></p>
</div></blockquote>
<p>Process 3-4: <span class="math notranslate nohighlight">\(\Delta U_{\rm 3-4} = Q_{\rm 3-4} - W_{\rm 3-4}\)</span>, where <span class="math notranslate nohighlight">\(Q_{\rm 3-4} = 0\)</span></p>
<blockquote>
<div><p>thus <span class="math notranslate nohighlight">\(W_{\rm 3-4} = U_{\rm 3} - U_{\rm 4} = m(u_{\rm 3} - u_{\rm 4}) =  mc_{\rm v}(T_{\rm 3} - T_{\rm 4})\)</span></p>
</div></blockquote>
<p>Process 4-1: <span class="math notranslate nohighlight">\(\Delta U_{\rm 4-1} = Q_{\rm 4-1} - W_{\rm 4-1}\)</span>, where <span class="math notranslate nohighlight">\(Q_{\rm 4-1} = 0\)</span></p>
<blockquote>
<div><p>thus <span class="math notranslate nohighlight">\(Q_{\rm 4-1} = U_{\rm 1} - U_{\rm 4} = m(u_{\rm 1} - u_{\rm 4}) =  mc_{\rm v}(T_{\rm 1} - T_{\rm 4})\)</span></p>
</div></blockquote>
<p>As seen, each heat transfer and work term associated with each process can be related to the change in internal energy (or temperature using <span class="math notranslate nohighlight">\(c_{\rm v}\)</span>). Note that this is in contrast to the Brayton Cycle analysis where the heat transfer and work terms are related to changes in enthalpy (or temperature using <span class="math notranslate nohighlight">\(c_{\rm p}\)</span>). The use of <span class="math notranslate nohighlight">\(c_{\rm p}\)</span> and <span class="math notranslate nohighlight">\(c_{\rm p}\)</span> depends only on whether changes in enthalpy or energy are of interest, regardless of the process being constant volume, pressure, etc. This is because of our assumption that air is an ideal gas, in which case specific heats are a function of only temperature and the meaning of the constant pressure or volume substripts is no lnger relevent. Refer to <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#usingspecificheat"><span class="std std-numref">Section 6.4</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#usingspecificheat"><span class="std std-ref">Using Specific Heats with Ideal Gases</span></a> for more discussion.</p>
<p>For the isentropic compression and expansion processes we can use any of the isentropic equations:<span class="math notranslate nohighlight">\(\frac{T_2}{T_1} = (\frac{v_1}{v_2})^{k-1}\)</span>, <span class="math notranslate nohighlight">\(\frac{T_2}{T_1} = (\frac{p_2}{p_1})^{\frac{k-1}{k}}\)</span>, or <span class="math notranslate nohighlight">\(\frac{p_2}{p_1} = (\frac{v_1}{v_2})^{k}\)</span>. Another strategy would be to use Cantera to determine specific entropy at a known state condition, and equate this to the specific entropy at the state either before/after compression/expansion to determine relevent state properties. This would be useful is gas ideality or air-standard assumptions were not used.</p>
<p>For all processes the ideal gas law can be applied <span class="math notranslate nohighlight">\(Pv = RT\)</span>, where <em>R</em> is the gas constant, or <span class="math notranslate nohighlight">\(R = \frac{\bar{R}}{M}\)</span>. But also relevent state properties could be solved directly using Cantera without having to assume gas ideality.</p>
<p>The thermal efficiency of the Ideal Otto Cycle can be determined using <a class="reference internal" href="Second%20Law%20of%20Thermodynamics.html#equation-eq-a11">(8.39)</a> below once the appropriate heat transfer and work terms are solved for. The general startegy for this is to use combinations of the above equations and/or Cantera to determine the relevent state properties.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa11">
<span class="eqno">(10.11)<a class="headerlink" href="#equation-eq-aa11" title="Link to this equation">#</a></span>\[\eta_{\rm Otto} = \frac{W_{\rm net}}{Q_{\rm in}} = \frac{W_{\rm 1-2}+W_{\rm 3-4}}{Q_{\rm in}}=\frac{Q_{\rm net}}{Q_{\rm in}} = \frac{Q_{\rm 2-3}+Q_{\rm 4-1}}{Q_{\rm in}}\]</div>
<section id="example-analysis-of-an-ideal-otto-cycle">
<h4><span class="section-number">10.3.1.1. </span>Example - Analysis of an Ideal Otto Cycle<a class="headerlink" href="#example-analysis-of-an-ideal-otto-cycle" title="Link to this heading">#</a></h4>
<p>An ideal Otto cycle has a compression ratio of 8. At the beginning of the compression process the pressure and temperature are 95 kPa and 27 °C, respectively. 750 kJ/kg of heat is transferred to the system during the constant volume heat addition process. Determine: a) pressure and temperature at the end of the heat addition process, b) specific net work output and c) thermal efficiency of the cycle. Assume air-standard properties</p>
<blockquote>
<div><p><strong>Solution</strong> For this problem we can take advantage of the fact that there are only two unique volumes. The compression ratio is the ratio of the largest volume relative to the minimum. We also know the most information prior to the compression process so it will likely be most useful beginning our analysis there and then working around the cycle to determine other state properties. Since process 1-2 is isentropic we can begin with an isentropic equation to determine relevent information following compression.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>

<span class="c1">#determine specific heat ratio</span>
<span class="n">state1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state1</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">27</span><span class="o">+</span><span class="mf">273.15</span> <span class="c1">#K</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">95</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># Pa</span>
<span class="n">state1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T1</span><span class="p">,</span><span class="n">p1</span>
<span class="n">cp</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cp</span>
<span class="n">cv</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cv</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">cv</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cv is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1 K-1 and k is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1">#then we can use T2/T1 = (v1/v2)^{k-1} to solve for T2</span>

<span class="n">comp_ratio</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1">#(v1/v2)</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">*</span><span class="p">(</span><span class="n">comp_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T2 after compression is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cv is 721.89 kJ kg-1 K-1 and k is 1.4
T2 after compression is 688.44 K
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>At this point we can solve for <em>p</em><sub>2</sub> using either of the other two isentropic equations.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">comp_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 after compression is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p2</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p2 after compression is 1743.17 kPa
</pre></div>
</div>
</div>
</div>
<p>We have enough information to solve for <em>T</em><sub>3</sub> with the information provided in the problem statement regarding specific heat transfer. <span class="math notranslate nohighlight">\(Q_{\rm 2-3} = mc_{\rm v}(T_{\rm 3} - T_{\rm 2})\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q23</span> <span class="o">=</span> <span class="mi">750</span> <span class="c1">#kJ/kg</span>
<span class="n">T3</span> <span class="o">=</span> <span class="n">q23</span> <span class="o">+</span> <span class="n">T2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T3 after heat addition is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T3 after heat addition is 1438.44 K
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Recognizing that <em>v</em><sub>2</sub> = <em>v</em><sub>3</sub> we can use the ideal gas law to solve for <em>p</em><sub>3</sub>, or the pressure after heat addition.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#p2/T2 = p3/T3</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">p2</span><span class="o">*</span><span class="n">T3</span><span class="o">/</span><span class="n">T2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p3 after heat addition is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p3</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p3 after heat addition is 3642.22 kPa
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Knowing <em>T</em><sub>3</sub> we can again use the appropriate isentropic equation to solve for <em>T</em><sub>4</sub>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#then we can use T4/T3 = (v3/v4)^{k-1} to solve for T2</span>

<span class="n">comp_ratio</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1">#(v1/v2 = v4/v3)</span>
<span class="n">T4</span> <span class="o">=</span> <span class="n">T3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">comp_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T4 after expansion is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T4 after expansion is 627.14 K
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>The net work output can be determined by summing either the work terms or the heat transfer terms. Summing the work terms we get the following:</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Wnet = W12+W34</span>
<span class="n">wnet</span> <span class="o">=</span> <span class="n">cv</span><span class="o">*</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span><span class="o">+</span><span class="n">cv</span><span class="o">*</span><span class="p">(</span><span class="n">T3</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span> <span class="c1">#J/kg/K need to divide by 1000 to get kJ</span>
<span class="n">wnet</span><span class="o">=</span><span class="n">wnet</span><span class="o">/</span><span class="mi">1000</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;wnet is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">wnet</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ/kg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wnet is 305.37 kJ/kg
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta</span> <span class="o">=</span> <span class="n">wnet</span><span class="o">/</span><span class="n">q23</span><span class="o">*</span><span class="mi">100</span> <span class="c1">#definition of thermal efficiency</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The thermal efficiency is 40.72 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="diesel-cycle">
<h3><span class="section-number">10.3.2. </span>Diesel Cycle<a class="headerlink" href="#diesel-cycle" title="Link to this heading">#</a></h3>
<p id="index-10">The <a class="reference internal" href="../genindex.html"><span class="std std-ref">Diesel Cycle</span></a> is another internal combustion engine based off of reciprocating piston-cylinder compression/expansion strokes and is also known as the ideal cycle for compression ignition engines. One of the main differences compared to the Otto Cycle is that rather than compressing an air-fuel mixture in the first compression stroke, only the air is compressed. This enables the air to be compressed to a higher pressure, above the autoignition point. Then, following compression, fuel is introduced with the help of a fuel injector to initiate the combustion reaction. Thus, the fuel injector has replaced the spark plug that is used in the Otto Cycle. Because the pressure following compression is higher compared to the Otto Cycle, the net work output is typically higher.</p>
<p>Another major difference compared to the Otto Cycle is that expansion stroke begins during the combustion process. Therefore, rather than the heat transfer being approximated as a constant volume process, it is approximated as constant pressure. This results in work output done during the combusion reaction and in the remaining expansion stroke that continues following combustion.</p>
<p>Using air-standard assumptions, the Diesel Cycle consists of four internally reversible processes and two piston strokes. Because air standard assumptions are used, the heat transfer occurs from/to and external reservoir. The four processes can be summarized as:</p>
<ol class="arabic simple">
<li><p>Isentropic compression</p></li>
<li><p>Constant pressure heat addition from an external source</p></li>
<li><p>Isentropic expansion</p></li>
<li><p>Constant volume heat rejection</p></li>
</ol>
<p>A piston-cylinder representation of the air-standard Diesel Cycle is shown below in <a class="reference internal" href="#diesel"><span class="std std-numref">Figure 10.9</span></a>. Starting on the left at state 1, compression work (<span class="math notranslate nohighlight">\(W_{\rm 12}\)</span>) is done to the piston isentropically. Then, heat is added (<span class="math notranslate nohighlight">\(Q_{\rm 23}\)</span>) from an external source while the piston-cylinder pressure remains constant. This results in an increase in temperature and volume and expansion work. Following heat addition, the piston continues to expand back to the initial volume, doing work to the surroundings (<span class="math notranslate nohighlight">\(W_{\rm 34}\)</span>), resulting in a temperature decrease of the air. Finally, the air is further cooled by rejecting heat at constant volume to an external source, going from state 4 to state 1.</p>
<figure class="align-default" id="diesel">
<img alt="../_images/diesel.png" src="../_images/diesel.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.9 </span><span class="caption-text">An Ideal Diesel Cycle, composed of two piston strokes and 4 unique states.</span><a class="headerlink" href="#diesel" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It is especially useful to visualize the Diesel  Cycle using both a <em>T-s</em> and <em>p-v</em> disgram to understand where all of the work and heat transfer processes are occuring. These are shown below in <a class="reference internal" href="#diesel-chart"><span class="std std-numref">Figure 10.10</span></a>. Going from state 1 to state 2, notice on the <em>T-s</em> diagram that the isentropic work process consists of a vertical line increasing in temperature, whereas on the <em>p-v</em> diagram the volume decreases. As heat is added during process 2-3, temperature increases as would be expected keeping pressure constant, and notice on the <em>p-v</em> diagram this results in a horizontal line corresponding to an increase in volume, and thus expansion work. Expansion during process 3-4 is isentropic, corresponding to a vertical line decreasing in temperature as seen on the <em>T-s</em> diagram and increase in volume and corresponding decrease in pressure as seen on the <em>p-v</em> diagram. Finally, as heat is rejected, both temperature and entropy decrease, as well as pressure.</p>
<figure class="align-default" id="diesel-chart">
<img alt="../_images/diesel_chart.png" src="../_images/diesel_chart.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.10 </span><span class="caption-text"><em>T-s</em> and <em>p-v</em> diagrams for the Ideal Diesel Cycle, indicating all relevent heat transfer and work terms, as well as isentropic and isobaric processes.</span><a class="headerlink" href="#diesel-chart" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Analysis of each of the processes within the Diesel cycle may be performed in a similar manner to the Otto Cycle. I.e., using the closed system energy conservation equation (<a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-numref">Section 5.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-ref">Energy Transfer and The First Law</span></a>), ideal gas law (<a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-numref">Section 4.2</span></a> <a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-ref">Ideal Gas Equation of State</span></a>), and when applicable the isentropic ideal gas equations from (<a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a>). The only process that is analyzed differently is process 2-3 because there are combined heat transfer and work terms. The boundary work term is straightforward to determine becuase it is assumed to occur at constant pressure, thus <span class="math notranslate nohighlight">\(W = p\Delta V\)</span>. Starting from the closed system energy conservation equation (<span class="math notranslate nohighlight">\(\Delta U = 0 = Q_{\rm net} - W_{\rm net}\)</span>) for each process, the following equations can be derived.</p>
<p>Process 2-3: <span class="math notranslate nohighlight">\(\Delta U_{\rm 2-3} = Q_{\rm 2-3} - W_{\rm 2-3}\)</span></p>
<blockquote>
<div><p>where
<span class="math notranslate nohighlight">\(W_{\rm 2-3} = p\Delta V = p(V_{\rm 3} - V_{\rm 2}) = pm(v_{\rm 3} - v_{\rm 2})\)</span></p>
</div></blockquote>
<blockquote>
<div><p>thus <span class="math notranslate nohighlight">\(Q_{\rm 2-3} = (U_{\rm 3} - U_{\rm 2}) + p(V_{\rm 3} - V_{\rm 2})  = (H_{\rm 3} - H_{\rm 2}) =  mc_{\rm p}(T_{\rm 3} - T_{\rm 2})\)</span></p>
</div></blockquote>
<p>As seen, the heat transfer, because it occurs at constant pressure, is equal to the change in enthalpy during process 2-3.</p>
<p>Like the Otto Cycle, we can use any of the isentropic equations:<span class="math notranslate nohighlight">\(\frac{T_2}{T_1} = (\frac{v_1}{v_2})^{k-1}\)</span>, <span class="math notranslate nohighlight">\(\frac{T_2}{T_1} = (\frac{p_2}{p_1})^{\frac{k-1}{k}}\)</span>, or <span class="math notranslate nohighlight">\(\frac{p_2}{p_1} = (\frac{v_1}{v_2})^{k}\)</span> for the isentropic compression and expansion processes. Another strategy would be to use Cantera to determine specific entropy at a known state condition, and equate this to the specific entropy at the state either before/after compression/expansion to determine relevent state properties. This would be useful is gas ideality or air-standard assumptions were not used.</p>
<p>Also like the Otto Cycle, the ideal gas law can be applied for all processes. But also relevent state properties could be solved directly using Cantera without having to assume gas ideality.</p>
<p>The thermal efficiency of the Ideal Diesel Cycle can be determined using <a class="reference internal" href="#equation-eq-aa12">(10.12)</a> below once the appropriate heat transfer and work terms are solved for. The general startegy for this is similar to the Otto Cycle - i.e., use combinations of the above equations and/or Cantera to determine the relevent state properties. Notice the additional work term in the numerator.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa12">
<span class="eqno">(10.12)<a class="headerlink" href="#equation-eq-aa12" title="Link to this equation">#</a></span>\[\eta_{\rm Diesel} = \frac{W_{\rm net}}{Q_{\rm in}} = \frac{W_{\rm 1-2}+W_{\rm 2-3}+W_{\rm 3-4}}{Q_{\rm in}}=\frac{Q_{\rm net}}{Q_{\rm in}} = \frac{Q_{\rm 2-3}+Q_{\rm 4-1}}{Q_{\rm in}}\]</div>
<section id="example-analysis-of-an-ideal-diesel-cycle">
<h4><span class="section-number">10.3.2.1. </span>Example - Analysis of an Ideal Diesel Cycle<a class="headerlink" href="#example-analysis-of-an-ideal-diesel-cycle" title="Link to this heading">#</a></h4>
<p>A diesel cycle has a compression ratio of 20:1 with an inlet at 95kPa, 290K and with volume of 0.5L. The maximum temperature is 1800K. Find the maximum pressure, net specific work and η. Assume air-standard properties.</p>
<blockquote>
<div><p><strong>Solution</strong> Like it is for the Otto Cycle, the compression ratio is the ratio of the largest volume relative to the minimum. We also know the most information prior to the compression process so it will likely be most useful beginning our analysis there and then working around the cycle to determine other state properties. Since process 1-2 is isentropic we can begin with an isentropic equation to determine relevent information following compression.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>

<span class="c1">#determine specific heat ratio</span>
<span class="n">state1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state1</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">290</span> <span class="c1">#K</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">95</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># Pa</span>
<span class="n">state1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T1</span><span class="p">,</span><span class="n">p1</span>
<span class="n">cp</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cp</span>
<span class="n">cv</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">cv</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">cv</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cv is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1 K-1 and k is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1">#then we can use T2/T1 = (v1/v2)^{k-1} to solve for T2</span>

<span class="n">comp_ratio</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">#(v1/v2)</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">*</span><span class="p">(</span><span class="n">comp_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T2 after compression is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cv is 720.84 kJ kg-1 K-1 and k is 1.4
T2 after compression is 960.61 K
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>At this point we can solve for <em>p</em><sub>2</sub> using either of the other two isentropic equations.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">comp_ratio</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 after compression is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p2</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa. This is the highest pressure in the cycle.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p2 after compression is 6293.64 kPa. This is the highest pressure in the cycle.
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Knowing this we can equate this pressure to <em>p</em><sub>3</sub> because the heat addition occurs at constant pressure. Also, the highest temperature occurs after heat addition, at state 3, so we know two state properties at state 3. We can solve for <em>v</em><sub>3</sub> knowing <em>p</em><sub>3</sub> and <em>T</em><sub>3</sub>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_bar</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1">#kJ/kmol/K</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">28.99</span> <span class="c1"># kg/kmol</span>
<span class="n">p3</span><span class="o">=</span><span class="n">p2</span> <span class="c1">#constant pressure heat addition</span>
<span class="n">T3</span> <span class="o">=</span> <span class="mi">1800</span> <span class="c1">#K provided in problem statement as maximum cycle temperature</span>
<span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p3</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">#m3/kg</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v3 after combustion is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v3 after combustion is 0.08 m3 kg-1
</pre></div>
</div>
</div>
</div>
<p>Knowing that the final expansion process is isentropic, we also know the specific entropy at state 3, and can equate this to specific entropy at state 4. But we don’t know any other state properties at state 4. However, we also know that <em>v</em><sub>4</sub> = <em>v</em><sub>1</sub> and we know two state properties at state 1 and can therefore determine <em>v</em><sub>4</sub>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#use ideal gas law to determine v1/v4</span>
<span class="n">R_bar</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1">#kJ/kmol/K</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">28.99</span> <span class="c1"># kg/kmol</span>
<span class="n">v1</span><span class="o">=</span><span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p1</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">#kg</span>
<span class="n">v4</span><span class="o">=</span><span class="n">v1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v1 and v4 are&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1 and v4 are 0.88 m3 kg-1
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>We can use an isentropic equation to solve for <em>T</em><sub>4</sub>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T4</span> <span class="o">=</span> <span class="n">T3</span><span class="o">*</span><span class="p">(</span><span class="n">v3</span><span class="o">/</span><span class="n">v4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T4 after expansion is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T4 after expansion is 698.49 K
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>The net work output can be determined by summing either the work terms or the heat transfer terms. We also need the mass, which can be determined from the given volume at state 1. Summing the work terms we get the following:</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#L</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">V1</span><span class="o">*</span><span class="mf">.001</span> <span class="c1"># to get m3</span>
<span class="n">m</span><span class="o">=</span><span class="n">p1</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">V1</span><span class="o">/</span><span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T1</span><span class="p">)</span> <span class="c1">#kg</span>

<span class="c1">#Wnet = W12+W23+W34</span>
<span class="c1">#v1/v2 = comp_ratio</span>

<span class="n">v2</span> <span class="o">=</span> <span class="n">v1</span><span class="o">/</span><span class="n">comp_ratio</span>
<span class="n">wnet</span> <span class="o">=</span> <span class="n">cv</span><span class="o">*</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span><span class="o">+</span><span class="n">p2</span><span class="o">*</span><span class="p">(</span><span class="n">v3</span><span class="o">-</span><span class="n">v2</span><span class="p">)</span><span class="o">+</span><span class="n">cv</span><span class="o">*</span><span class="p">(</span><span class="n">T3</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span> <span class="c1">#J/kg/K need to divide by 1000 to get kJ</span>
<span class="n">wnet</span><span class="o">=</span><span class="n">wnet</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">Wnet</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">wnet</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wnet is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Wnet</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wnet is 0.31 kJ
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q23</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">T3</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">Q23</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">Wnet</span><span class="o">/</span><span class="n">Q23</span><span class="o">*</span><span class="mi">100</span> <span class="c1">#definition of thermal efficiency</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4837295142031297
The thermal efficiency is 65.1 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="programming-example-plotting-analysis-of-an-ideal-diesel-cycle">
<h4><span class="section-number">10.3.2.2. </span>Programming Example - Plotting “Analysis of an Ideal Diesel Cycle”<a class="headerlink" href="#programming-example-plotting-analysis-of-an-ideal-diesel-cycle" title="Link to this heading">#</a></h4>
<p>Plot the temperature versus specific entropy and pressure versus specific volume for the prior mentioned Diesel Cycle. Use Cantera rather than assuming air-standard properties. “A diesel cycle has a compression ratio of 20:1 with an inlet at 95kPa, 290K. The maximum temperature is 1800K.”</p>
<blockquote>
<div><p><strong>Solution</strong> We will use Cantera rather than ideal gas law and use Cantera to determine specific entropies for isentropic processes rather than using isentropic equations. We will need to generate plots ranging from extreme values at each state, and can use functions and lists to help us. But first, we should find the <em>T</em>, <em>s</em>, <em>p</em> and <em>v</em> at each state to determine our bounds. Starting with state 1.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>

<span class="c1">#state1</span>
<span class="n">state1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state1</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mi">290</span> <span class="c1">#K</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">95</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># Pa</span>
<span class="n">state1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T1</span><span class="p">,</span><span class="n">p1</span>
<span class="n">s1</span><span class="o">=</span><span class="n">state1</span><span class="o">.</span><span class="n">SP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">state1</span><span class="o">.</span><span class="n">SV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T1 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K,&quot;</span><span class="p">,</span> <span class="s2">&quot;s1 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;J kg-1 K-1,&quot;</span><span class="p">,</span> <span class="s2">&quot;p1 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Pa,&quot;</span><span class="p">,</span> <span class="s2">&quot;v1 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T1 =  290 K, s1 =  6876.03 J kg-1 K-1, p1 =  95000 Pa, v1 =  0.88 m3 kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#state 2</span>
<span class="n">state2</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state2</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">comp_ratio</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">s2</span><span class="o">=</span><span class="n">s1</span>
<span class="n">v2</span><span class="o">=</span><span class="n">v1</span><span class="o">/</span><span class="n">comp_ratio</span>
<span class="n">state2</span><span class="o">.</span><span class="n">SV</span> <span class="o">=</span> <span class="n">s2</span><span class="p">,</span><span class="n">v2</span>
<span class="n">p2</span><span class="o">=</span><span class="n">state2</span><span class="o">.</span><span class="n">SP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">state2</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T2 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K,&quot;</span><span class="p">,</span> <span class="s2">&quot;s2 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;J kg-1 K-1,&quot;</span><span class="p">,</span> <span class="s2">&quot;p2 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Pa,&quot;</span><span class="p">,</span> <span class="s2">&quot;v2 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T2 =  900.64 K, s2 =  6876.03 J kg-1 K-1, p2 =  5900719.94 Pa, v2 =  0.04 m3 kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#state 3</span>
<span class="n">state3</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state3</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">p3</span><span class="o">=</span><span class="n">p2</span>
<span class="n">T3</span> <span class="o">=</span> <span class="mi">1800</span> <span class="c1">#K</span>
<span class="n">state3</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T3</span><span class="p">,</span><span class="n">p3</span>
<span class="n">s3</span><span class="o">=</span><span class="n">state3</span><span class="o">.</span><span class="n">SP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">state3</span><span class="o">.</span><span class="n">SV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T3 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K,&quot;</span><span class="p">,</span> <span class="s2">&quot;s3 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;J kg-1 K-1,&quot;</span><span class="p">,</span> <span class="s2">&quot;p3 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Pa,&quot;</span><span class="p">,</span> <span class="s2">&quot;v3 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T3 =  1800 K, s3 =  7701.0 J kg-1 K-1, p3 =  5900719.94 Pa, v3 =  0.09 m3 kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#state 4</span>
<span class="n">state4</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state4</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">s4</span><span class="o">=</span><span class="n">s3</span>
<span class="n">v4</span> <span class="o">=</span> <span class="n">v1</span>
<span class="n">state4</span><span class="o">.</span><span class="n">SV</span> <span class="o">=</span> <span class="n">s4</span><span class="p">,</span><span class="n">v4</span>
<span class="n">T4</span><span class="o">=</span><span class="n">state4</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">state4</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T4 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">T4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;K,&quot;</span><span class="p">,</span> <span class="s2">&quot;s4 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">s4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;J kg-1 K-1,&quot;</span><span class="p">,</span> <span class="s2">&quot;p4 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Pa,&quot;</span><span class="p">,</span> <span class="s2">&quot;v4 = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T4 =  860.28 K, s4 =  7701.0 J kg-1 K-1, p4 =  281816.92 Pa, v4 =  0.88 m3 kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#process 1-2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">temps_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">+</span><span class="p">(</span><span class="n">T2</span><span class="o">-</span><span class="n">T1</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">T2</span><span class="o">-</span><span class="n">T1</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between T1 and T2</span>
<span class="c1"># because entropy is constant, we just need a list of entropies with the same length</span>
<span class="n">entropies_12</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
  <span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temps_12</span><span class="p">),</span>
  <span class="n">fill_value</span><span class="o">=</span><span class="n">s1</span>
<span class="p">)</span>
<span class="n">pres_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="o">+</span><span class="p">(</span><span class="n">p2</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">p2</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between p1 and p2</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_12</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#now we need to use Cantera to determine specific volumes for each of these pressure values</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vol</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">state12</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
    <span class="n">state12</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">#K</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">entropies_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">vguess</span> <span class="o">=</span> <span class="n">v1</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">state12</span><span class="o">.</span><span class="n">SV</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span><span class="n">v</span> <span class="c1"># needed because there is no ST option to set state in Cantera. We will have to solve for v iterively knowing the T and P</span>
        <span class="n">Tsolve</span> <span class="o">=</span> <span class="n">state12</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Tsolve</span><span class="o">-</span><span class="n">T</span><span class="p">)</span>
    <span class="n">bnds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v2</span><span class="p">,</span><span class="n">v1</span><span class="p">)]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">solve</span><span class="p">,</span> <span class="n">vguess</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vols_12</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_12</span><span class="p">)):</span>
    <span class="n">vols_12</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vol</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>


<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># add one subplot</span>
<span class="n">ax2</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># add a second subplot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">,</span><span class="n">temps_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_12</span><span class="p">,</span><span class="n">pres_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">.02</span><span class="p">,</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.02</span><span class="p">,</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Entropy $({</span><span class="se">\\</span><span class="s1">mathrm{J kg^{-1}K^{-1}})}$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Volume $(</span><span class="se">\\</span><span class="s1">mathrm{m^</span><span class="si">{3}</span><span class="s1">})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $(</span><span class="se">\\</span><span class="s1">mathrm{^</span><span class="se">\\</span><span class="s1">circ C})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure $(</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Pa}</span><span class="s1">)$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#ax1.set_ylabel(&#39;$c_{\\mathrm{p}}$ $({\\mathrm{kJ kg^{-1}K^{-1}})}$&#39;,  fontsize=12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># add spacing between subplots</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;T-s&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;p-v&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figures/diesel_cantera_12.png&#39;</span><span class="p">)</span><span class="c1"># used to save the figure if you desire</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2415795f1e139a05ef4221070a3faea91c7a1446d4cfdb817541f87b442108ce.png" src="../_images/2415795f1e139a05ef4221070a3faea91c7a1446d4cfdb817541f87b442108ce.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#process 2-3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">temps_23</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="o">+</span><span class="p">(</span><span class="n">T3</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">T3</span><span class="o">-</span><span class="n">T2</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between T2 and T3</span>
<span class="c1"># because pressure is constant, we can make a list of pressures with the same length</span>
<span class="n">pres_23</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
  <span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temps_23</span><span class="p">),</span>
  <span class="n">fill_value</span><span class="o">=</span><span class="n">p2</span>
<span class="p">)</span>
<span class="c1">#now we need to use Cantera to determine specific volumes and entropies for each temperature and pressure value</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_states</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">state23</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
    <span class="n">state23</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
    <span class="n">state23</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">p2</span>
    <span class="k">return</span> <span class="n">state23</span><span class="o">.</span><span class="n">SV</span>

<span class="n">entropies_23</span><span class="o">=</span><span class="p">[]</span>
<span class="n">vols_23</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temps_23</span><span class="p">:</span>
    <span class="n">entropies_23</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solve_states</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">vols_23</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solve_states</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># add one subplot</span>
<span class="n">ax2</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># add a second subplot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">,</span><span class="n">temps_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">,</span><span class="n">temps_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_12</span><span class="p">,</span><span class="n">pres_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_23</span><span class="p">,</span><span class="n">pres_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>



<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Entropy $({</span><span class="se">\\</span><span class="s1">mathrm{J kg^{-1}K^{-1}})}$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Volume $(</span><span class="se">\\</span><span class="s1">mathrm{m^</span><span class="si">{3}</span><span class="s1">})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $(</span><span class="se">\\</span><span class="s1">mathrm{^</span><span class="se">\\</span><span class="s1">circ C})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure $(</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Pa}</span><span class="s1">)$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#ax1.set_ylabel(&#39;$c_{\\mathrm{p}}$ $({\\mathrm{kJ kg^{-1}K^{-1}})}$&#39;,  fontsize=12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># add spacing between subplots</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;T-s&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;p-v&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figures/diesel_cantera_123.png&#39;</span><span class="p">)</span><span class="c1"># used to save the figure if you desire</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c0bb905c595e650f24eb35f0d44986ab7ec36cc2359324eb72335ffb77276a8c.png" src="../_images/c0bb905c595e650f24eb35f0d44986ab7ec36cc2359324eb72335ffb77276a8c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#process 3-4</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">temps_34</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">+</span><span class="p">(</span><span class="n">T4</span><span class="o">-</span><span class="n">T3</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">T4</span><span class="o">-</span><span class="n">T3</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between T3 and T4</span>
<span class="c1"># because entropy is constant, we just need a list of entropies with the same length</span>
<span class="n">entropies_34</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
  <span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temps_34</span><span class="p">),</span>
  <span class="n">fill_value</span><span class="o">=</span><span class="n">s3</span>
<span class="p">)</span>
<span class="n">pres_34</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span><span class="n">p4</span><span class="o">+</span><span class="p">(</span><span class="n">p4</span><span class="o">-</span><span class="n">p3</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">p4</span><span class="o">-</span><span class="n">p3</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between p3 and p4</span>
<span class="c1">#now we need to use Cantera to determine specific volumes for each of these pressure values</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vol</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">state34</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
    <span class="n">state34</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">temps_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">#K</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">entropies_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">vguess</span> <span class="o">=</span> <span class="n">v3</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">state34</span><span class="o">.</span><span class="n">SV</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span><span class="n">v</span> <span class="c1"># needed because there is no ST option to set state in Cantera. We will have to solve for v iterively knowing the T and P</span>
        <span class="n">Tsolve</span> <span class="o">=</span> <span class="n">state34</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Tsolve</span><span class="o">-</span><span class="n">T</span><span class="p">)</span>
    <span class="n">bnds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v3</span><span class="p">,</span><span class="n">v4</span><span class="p">)]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">solve</span><span class="p">,</span> <span class="n">vguess</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vols_34</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_34</span><span class="p">)):</span>
    <span class="n">vols_34</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vol</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># add one subplot</span>
<span class="n">ax2</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># add a second subplot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">,</span><span class="n">temps_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">,</span><span class="n">temps_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">,</span><span class="n">temps_34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_12</span><span class="p">,</span><span class="n">pres_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_23</span><span class="p">,</span><span class="n">pres_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_34</span><span class="p">,</span><span class="n">pres_34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_34</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">.3e6</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Entropy $({</span><span class="se">\\</span><span class="s1">mathrm{J kg^{-1}K^{-1}})}$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Volume $(</span><span class="se">\\</span><span class="s1">mathrm{m^</span><span class="si">{3}</span><span class="s1">})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $(</span><span class="se">\\</span><span class="s1">mathrm{^</span><span class="se">\\</span><span class="s1">circ C})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure $(</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Pa}</span><span class="s1">)$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#ax1.set_ylabel(&#39;$c_{\\mathrm{p}}$ $({\\mathrm{kJ kg^{-1}K^{-1}})}$&#39;,  fontsize=12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># add spacing between subplots</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;T-s&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;p-v&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figures/diesel_cantera_1234.png&#39;</span><span class="p">)</span><span class="c1"># used to save the figure if you desire</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b0b26df0eb700ac2f43b05c6199bb38d487543e6467343e5d4f284d94a1d9280.png" src="../_images/b0b26df0eb700ac2f43b05c6199bb38d487543e6467343e5d4f284d94a1d9280.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#process 4-1</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">temps_41</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T4</span><span class="p">,</span><span class="n">T1</span><span class="o">+</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">T1</span><span class="o">-</span><span class="n">T4</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between T3 and T4</span>
<span class="c1"># because volume is constant, we can make a list of specific volumes with the same length</span>
<span class="n">vols_41</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
  <span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temps_41</span><span class="p">),</span>
  <span class="n">fill_value</span><span class="o">=</span><span class="n">v4</span>
<span class="p">)</span>

<span class="n">pres_41</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span><span class="n">p1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">p1</span><span class="o">-</span><span class="n">p4</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,(</span><span class="n">p1</span><span class="o">-</span><span class="n">p4</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#50 steps between p1 and p2</span>

<span class="c1">#now we need to use Cantera to determine specific entropy for each of these temperature pressure pairs</span>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">state41</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
    <span class="n">state41</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">temps_41</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">#K</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">vols_41</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sguess</span> <span class="o">=</span> <span class="n">s4</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">state41</span><span class="o">.</span><span class="n">SV</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span><span class="n">v</span> <span class="c1"># needed because there is no ST option to set state in Cantera. We will have to solve for s iterively knowing the T and v</span>
        <span class="n">Tsolve</span> <span class="o">=</span> <span class="n">state41</span><span class="o">.</span><span class="n">TP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Tsolve</span><span class="o">-</span><span class="n">T</span><span class="p">)</span>
    <span class="n">bnds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">s1</span><span class="p">,</span><span class="n">s4</span><span class="p">)]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">solve</span><span class="p">,</span> <span class="n">sguess</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">entropies_41</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temps_41</span><span class="p">)):</span>
    <span class="n">entropies_41</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># add one subplot</span>
<span class="n">ax2</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># add a second subplot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">,</span><span class="n">temps_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">,</span><span class="n">temps_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">,</span><span class="n">temps_34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_41</span><span class="p">,</span><span class="n">temps_41</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_12</span><span class="p">,</span><span class="n">pres_12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_23</span><span class="p">,</span><span class="n">pres_23</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_34</span><span class="p">,</span><span class="n">pres_34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vols_41</span><span class="p">,</span><span class="n">pres_41</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temps_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vols_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">entropies_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_23</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_34</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">x1_tail</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x1_tail</span> <span class="o">=</span> <span class="n">entropies_41</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y1_tail</span> <span class="o">=</span> <span class="n">temps_41</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x1_head</span> <span class="o">=</span> <span class="n">entropies_41</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y1_head</span> <span class="o">=</span> <span class="n">temps_41</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow1</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x1_tail</span><span class="p">,</span> <span class="n">y1_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x1_head</span><span class="p">,</span> <span class="n">y1_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow1</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_12</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>

<span class="n">x2_tail</span> <span class="o">=</span> <span class="n">vols_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">y2_tail</span> <span class="o">=</span> <span class="n">pres_34</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="n">x2_head</span> <span class="o">=</span> <span class="n">vols_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">y2_head</span> <span class="o">=</span> <span class="n">pres_34</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">arrow2</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x2_tail</span><span class="p">,</span> <span class="n">y2_tail</span><span class="p">),</span> <span class="p">(</span><span class="n">x2_head</span><span class="p">,</span> <span class="n">y2_head</span><span class="p">),</span>
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">entropies_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">temps_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">.3e6</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_12</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_23</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">vols_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pres_34</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.1e6</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Entropy $({</span><span class="se">\\</span><span class="s1">mathrm{J kg^{-1}K^{-1}})}$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific Volume $(</span><span class="se">\\</span><span class="s1">mathrm{m^</span><span class="si">{3}</span><span class="s1">})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $(</span><span class="se">\\</span><span class="s1">mathrm{^</span><span class="se">\\</span><span class="s1">circ C})$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure $(</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Pa}</span><span class="s1">)$&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#ax1.set_ylabel(&#39;$c_{\\mathrm{p}}$ $({\\mathrm{kJ kg^{-1}K^{-1}})}$&#39;,  fontsize=12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># add spacing between subplots</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;T-s&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;p-v&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figures/diesel_cantera_1234.png&#39;</span><span class="p">)</span><span class="c1"># used to save the figure if you desire</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c97fc98e46057bf7ac610e603133060379f2e93c47d67687223e6077febe703.png" src="../_images/7c97fc98e46057bf7ac610e603133060379f2e93c47d67687223e6077febe703.png" />
</div>
</div>
</section>
</section>
<section id="stirling-cycle">
<h3><span class="section-number">10.3.3. </span>Stirling Cycle<a class="headerlink" href="#stirling-cycle" title="Link to this heading">#</a></h3>
<p id="index-11">The <a class="reference internal" href="../genindex.html"><span class="std std-ref">Stirling Cycle</span></a> is based on a reciprocating dual piston-cylinder design that recuperates heat internally to improve efficiency. The internal heat recuperation is acheived using a <a class="reference internal" href="../genindex.html"><span class="std std-ref">regenerator</span></a>, which is a type of thermal storage medium that receieves and transfers heat to different processes within the cycle. In contrast to the Otto and Diesel cycles, the Stirling Engine is heated via an external source and is therfore sometimes referred to as an external combustion engine - but in reality the heat source can be of any type, renewable or fossil. Because they rely on external heat transfer, these heat engines are often of interest for renewable energy systems that have a source of high temperature heat such as concentrated solar energy. In fact, in 2008, Sandia National Laboratories and Stirling Energy Systems set a world record 31.25% conversion efficiency of solar energy to electrical work using a Stirling engine coupled with a solar parabolic dish (<a class="reference external" href="https://newsreleases.sandia.gov/sandia-stirling-energy-systems-set-new-world-record-for-solar-to-grid-conversion-efficiency/">https://newsreleases.sandia.gov/sandia-stirling-energy-systems-set-new-world-record-for-solar-to-grid-conversion-efficiency/</a>). Since that time, photovoltaic efficiencies have surpassed this value and can be as high as 46.7% when coupled with solar concentration (<a class="reference external" href="https://www.nrel.gov/pv/cell-efficiency">https://www.nrel.gov/pv/cell-efficiency</a>). Nevertheless, Stirling heat engines remain of interest for a variety of applications due to their high efficiencies and flexibility to be integrated with varying heat sources.</p>
<p>The purpose of the regenerator is similar to the regenerator discussed prior for the Brayton cycle. That is, the temperature following expansion is well above the ambient temperature and in principle can be transferred internally prior to heat addition. The benefit is reduced external heat input to acheive the same final state, and external heat addition at the highest temperature possible. However, a Stirling Cycle, which is based on recipricating piston-cylinders cannot simply recuperate heat from a hot stream and transfer it to a cooler stream with the help of a heat exchanger operating at steady state conditions. Rather, because of the cyclical nature of the engine, the heat must be stored in a regenerator and transferred back for later use. To enable this, the Stirling Engine operates with two pistons, one hot and one cooler, with the hot piston transferring energy to the regenerator. The regenerator, in principle is any type of porous solid with a large specific heat that stores the internal heat and it is assumed that the heat stored in the working gas is negligable compared to the solid. The mechanics of the Stirling cycle are complex and cannot easily be broken down into discrete processes as easily as the Otto and Diesel cycles. Therefore, our analysis is limited to the highly idealized Stirling cycle which consist of four fully reversible processes. Using air-standard assumptions, the Ideal Stirling Cycle can be summarized as:</p>
<ol class="arabic simple">
<li><p>Constant temperature heat addition and expansion</p></li>
<li><p>Constant volume internal heat transfer to a regenerator</p></li>
<li><p>Constant temperature heat rejection and compression</p></li>
<li><p>Constant volume internal heat transfer from a regenerator</p></li>
</ol>
<p>The idealized Stirling Cycle is shown below in <a class="reference internal" href="#stirling"><span class="std std-numref">Figure 10.11</span></a>. Starting on the left process 1-2 consists of heat transfer from a high temperature reservoir and expansion of the hot side at a constant temperture. Then, process 2-3 consists of internal heat transfer to the regenerator while the total system volume remains constant. Notice that the volume of the hot side decreases while the cold side increases - but the net work associated with these processes is negligable and not considered in our analysis. Following internal heat transfer to the regenerator, the cold side is compressed while heat is simultanesouly transferred to the low temperature reservoir. Finally, during process 4-1, the regenerator transfers heat to the hot side, prior to external heating and to restart the cycle.</p>
<figure class="align-default" id="stirling">
<img alt="../_images/stirling.png" src="../_images/stirling.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.11 </span><span class="caption-text">An Ideal Stirling Cycle, composed of two pistons designed to recuperate heat internally with the help of a regenerator.</span><a class="headerlink" href="#stirling" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The Ideal Stirling Cycle is presented on a <em>T-s</em> a diagram below in <a class="reference internal" href="#stirling-chart"><span class="std std-numref">Figure 10.12</span></a>. Notice that there are no longer any isentropic processes like there were for the Otto, Diesel, Brayton and Carnot cycles. However, because each process in the cycle and completly reversible, the maximum efficiency that can be acheived is, in principle, the Carnot Efficiency.</p>
<figure class="align-default" id="stirling-chart">
<img alt="../_images/stirling_chart.png" src="../_images/stirling_chart.png" />
<figcaption>
<p><span class="caption-number">Fig. 10.12 </span><span class="caption-text"><em>T-s</em> diagram for the Ideal Stirling Cycle. Notice that compared to the Carnot Cycle, there are no isentropic processes, but the external heat addition terms occur at constant temperature.</span><a class="headerlink" href="#stirling-chart" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Analysis of each of the processes within the Stirling cycle may be performed in a similar manner to the prior piston-cyclinder based cycles, with two notable exceptions. First, because there are no isentropic processes the isentropic ideal gas equations from <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a> cannot be used. Second, because the compression and expansion process occur isothermally and reversibly, we can use the appropriate polytopic work equations with <em>n</em> = 1 from <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#polytropic"><span class="std std-numref">Section 6.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#polytropic"><span class="std std-ref">More on Boundary Work - Polytropic Process</span></a>. Thus, to analyze each process only the closed system energy conservation equation (<a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-numref">Section 5.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics.html#energytransfer"><span class="std std-ref">Energy Transfer and The First Law</span></a>),  ideal gas law (<a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-numref">Section 4.2</span></a> <a class="reference internal" href="Evaluation%20of%20Properties.html#idealgas"><span class="std std-ref">Ideal Gas Equation of State</span></a>) and <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#polytropic"><span class="std std-numref">Section 6.2</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Continued.html#polytropic"><span class="std std-ref">More on Boundary Work - Polytropic Process</span></a> equations are necessary.</p>
<p>The polytopic work for an isothermal process (i.e. <em>n</em> = 1) may be evaluated using the equations below for expansion and compression, respectively.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa13">
<span class="eqno">(10.13)<a class="headerlink" href="#equation-eq-aa13" title="Link to this equation">#</a></span>\[W_{\rm mech} = p_1V_1{\rm ln} \frac{V_2}{V_1} = p_2V_2{\rm ln} \frac{V_2}{V_1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-aa14">
<span class="eqno">(10.14)<a class="headerlink" href="#equation-eq-aa14" title="Link to this equation">#</a></span>\[W_{\rm mech} = p_3V_3{\rm ln} \frac{V_4}{V_3} = p_4V_4{\rm ln} \frac{V_4}{V_3}\]</div>
<p>In addition to calculating efficiency like the prior gas power cycles, the Stirling Cycle efficiency may also be calculated using the Carnot Efficiency equation, shown below in <a class="reference internal" href="#equation-eq-aa15">(10.16)</a>.</p>
<div class="math notranslate nohighlight" id="equation-eq-aa15">
<span class="eqno">(10.16)<a class="headerlink" href="#equation-eq-aa15" title="Link to this equation">#</a></span>\[\eta = 1- \frac{T_{\rm L}}{T_{\rm H}}=\frac{W_{\rm net}}{Q_{\rm in}}\]</div>
<section id="example-analysis-of-an-ideal-stirling-cycle">
<h4><span class="section-number">10.3.3.1. </span>Example - Analysis of an Ideal Stirling Cycle<a class="headerlink" href="#example-analysis-of-an-ideal-stirling-cycle" title="Link to this heading">#</a></h4>
<p>Consider an ideal Stirling cycle. At the beginning of the isothermal compression process, air is at 100 KPa and 300K. Total heat supplied from a source at 1700K is 800 kJ/kg. Determine the pressure after expansion, the net specific work and thermal efficiency, η. Assume air-standard properties.</p>
<blockquote>
<div><p><strong>Solution</strong> We will start at state 3, prior to compression where we know the most information. We will use ideal gas law but below is a comparison to using Cantera as well.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cantera</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ct</span>

<span class="c1">#state3</span>

<span class="n">R_bar</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1">#kJ/kmol/K</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">28.99</span> <span class="c1"># kg/kmol</span>

<span class="n">state3</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.yaml&#39;</span><span class="p">)</span>
<span class="n">state3</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="s1">&#39;N2:0.79 O2: 0.21&#39;</span>
<span class="n">T3</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1">#K</span>
<span class="n">T4</span> <span class="o">=</span> <span class="n">T3</span> <span class="c1">#process 3-4 is isothermal</span>
<span class="n">p3</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># Pa</span>
<span class="n">state3</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">T3</span><span class="p">,</span><span class="n">p3</span>
<span class="n">v3_cantera</span> <span class="o">=</span> <span class="n">state3</span><span class="o">.</span><span class="n">SV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#specific volume calculated using Cantera</span>
<span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p3</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">#m3 kg-1</span>
<span class="n">v2</span><span class="o">=</span><span class="n">v3</span> <span class="c1"># process 2-3 is constant volume</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v3 calculated using Cantera is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v3_cantera</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v3 calculated using ideal gas law  is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v3 calculated using Cantera is =  0.86 m3 kg-1
v3 calculated using ideal gas law  is =  0.86 m3 kg-1
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Solution</strong> Now we will use the additional information provided.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="mi">1700</span> <span class="c1">#K</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span> <span class="c1">#isothermal for process 1-2</span>
<span class="n">q12</span> <span class="o">=</span> <span class="mi">800</span> <span class="c1">#kJ/kg</span>

<span class="n">w12</span><span class="o">=</span><span class="n">q12</span> <span class="c1"># apply first law, delta_U = 0 because constant temperature</span>

<span class="n">R_bar</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1">#kJ/kmol/K</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">28.99</span> <span class="c1"># kg/kmol</span>

<span class="c1">#Recognize we know two properties at state 2.</span>
<span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="c1">#kPa</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The specific heat transfer and work to and by the cycle is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">q12</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 calculated using ideal gas law is is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The specific heat transfer and work to and by the cycle is =  800 kJ kg-1
p2 calculated using ideal gas law is is =  566.67 kPa
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Solution</strong> Now we know the specific expansion work, <em>p</em><sub>2</sub>, <em>v</em><sub>2</sub> and we can solve for <em>v</em><sub>1</sub> using <a class="reference internal" href="#equation-eq-aa12">(10.12)</a></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w12 = p2v2ln(v2/v1)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">v2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">w12</span><span class="o">/</span><span class="n">p2</span><span class="o">/</span><span class="n">v2</span><span class="p">)</span>
<span class="n">v4</span><span class="o">=</span><span class="n">v1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v1 calculated using polytropic work equation is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;m3 kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1 calculated using polytropic work equation is =  0.17 m3 kg-1
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Solution</strong> We now know two state properties at 4 and can calulate p4</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_bar</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1">#kJ/kmol/K</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">28.99</span> <span class="c1"># kg/kmol</span>

<span class="c1">#Recognize we know two properties at state 4.</span>
<span class="n">p4</span> <span class="o">=</span> <span class="p">(</span><span class="n">R_bar</span><span class="o">/</span><span class="n">M</span><span class="o">*</span><span class="n">T4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v4</span><span class="p">)</span> <span class="c1">#kPa</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p4 calculated using ideal gas law is is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p4 calculated using ideal gas law is is =  515.98 kPa
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Solution</strong> Knowing, <em>v</em><sub>4</sub>, <em>v</em><sub>3</sub> <em>p</em><sub>3</sub>/<em>p</em><sub>4</sub> we can solve for <em>w</em><sub>34</sub> using <a class="reference internal" href="#equation-eq-aa13">(10.13)</a></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w12 = p3v3ln(v4/v3)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">w34</span> <span class="o">=</span> <span class="n">p3</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="n">v3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">v4</span><span class="o">/</span><span class="n">v3</span><span class="p">)</span>
<span class="n">q34</span> <span class="o">=</span> <span class="n">w12</span> <span class="c1"># first law for an isothermal process</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The specific heat transfer and work from and to the cycle is = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">w34</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The specific heat transfer and work from and to the cycle is =  -141.18 kJ kg-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_net</span> <span class="o">=</span> <span class="n">w12</span><span class="o">+</span><span class="n">w34</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">w_net</span><span class="o">/</span><span class="n">q12</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The pressure after expansion is &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kPa&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The net specific work is &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">wnet</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;kJ kg-1&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The thermal efficiency, η, is &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The pressure after expansion is  566.67 kPa
The net specific work is  551.34 kJ kg-1
The thermal efficiency, η, is  82.35 %
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Solution</strong> Let’s compare our computed efficiency to the Carnot Efficiency</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Th</span> <span class="o">=</span> <span class="n">T1</span>
<span class="n">Tl</span> <span class="o">=</span> <span class="n">T3</span>
<span class="n">eta_carnot</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tl</span><span class="o">/</span><span class="n">Th</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Carnot efficiency, η, is &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">eta_carnot</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Carnot efficiency, η, is  82.35 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ericsson-cycle">
<h3><span class="section-number">10.3.4. </span>Ericsson Cycle<a class="headerlink" href="#ericsson-cycle" title="Link to this heading">#</a></h3>
<p id="index-12">The  is another type of regenerative gas power cycle that enables constant temperature heat addition and heat rejection. It is composed of 4 completely reversible processes, so the theoretical thermal efficiency is also equivilent of the Carnot efficiency, like the Stirling cycle. Unlike the Stirling cycle, the Ericsson Cycle is based on a steady flow system that utilizes turbines and compressors that are coupled with heat addition and heat rejection, respectively. Thus, expansion and compression are also not isentropic. The major distinction in terms of analysis compared to the Stirling cycle is that the regeneration occurs via a heat exchanger (i.e. no sensible energy storage), and the heat transfer during regeneration occurs at constant pressure, just like the regenerator in the Brayton Cycle.</p>
<p>Using air-standard assumptions, the four full reversible processes of the Ideal Ericsson Cycle can be summarized as:</p>
<ol class="arabic simple">
<li><p>Constant temperature heat addition and expansion</p></li>
<li><p>Constant pressure internal heat transfer to a regenerator</p></li>
<li><p>Constant temperature heat rejection and compression</p></li>
<li><p>Constant pressure internal heat transfer from a regenerator</p></li>
</ol>
<p>Becuase the Ericsson Cycle is composed of steady state devices, each process should be analyzed using the steady state open system energy balance discussed in <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Open%20Systems.html#firstlawopen"><span class="std std-numref">Section 7</span></a> <a class="reference internal" href="First%20Law%20of%20Thermodynamics%20Open%20Systems.html#firstlawopen"><span class="std std-ref">First Law of Thermodynamics - Open Systems</span></a>. Like all other gas power cycles, the ideal gas law can be applied to any state within the cycle, and like the Stirling Cycle isentropic ideal gas equations from <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-numref">Section 9.2</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#isentropicidealgas"><span class="std std-ref">Isentropic Processes of Ideal Gases</span></a> cannot be used. Unlike the Stirling Cycle, the work terms associated with compression and expansion should be evaluated using the <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#reversiblework"><span class="std std-numref">Section 9.3</span></a> <a class="reference internal" href="Entropy%20Change%20of%20Real%20Processes%20v2.html#reversiblework"><span class="std std-ref">Reversible Steady State Work</span></a>equation when <em>k</em> = 1 (i.e. isothermal), shown below,</p>
<div class="math notranslate nohighlight" id="equation-eq-aa15">
<span class="eqno">(10.16)<a class="headerlink" href="#equation-eq-aa15" title="Link to this equation">#</a></span>\[w_{\rm rev} = -pv ln \frac{p_2}{p_1}\]</div>
</section>
<section id="exercise-8">
<span id="exercise8"></span><h3><span class="section-number">10.3.5. </span>Exercise 8<a class="headerlink" href="#exercise-8" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>A stationary gas-turbine power plant operates on a simple ideal Brayton cycle with air as the
working fluid. The air enters the compressor at 95 kPa and 290 K and the turbine at 760 kPa and
1100 K. Heat is transferred to air at a rate of 35,000 kW. Determine the power delivered by this
plant (a) assuming constant specific heats at room temperature and (b) accounting for the variation
of specific heats with temperature.</p></li>
<li><p>A gas turbine power plant operates on the simple Brayton cycle with air as the working fluid and
delivers 32 MW of power. The minimum and maximum temperatures in the cycle are 310 and 900
K, and the pressure of air at the compressor exit is 8 times the value at the compressor inlet.
Assuming an isentropic efficiency of 80% for the compressor and 86% for the turbine, determine
the mass flow rate of air through the cycle. Account for the variation of specific heats with
temperature.</p></li>
<li><p>A Brayton cycle using air as the working fluid operates at steady state with
intercooling and reheating. The net power output is 10 MW. Use data provided below:</p>
<ol class="arabic simple">
<li><p>Sketch the T-s diagram for the cycle</p></li>
<li><p>Determine the mass flowrate of air, in kg/s</p></li>
<li><p>The rate of heat transfer, in kW, during all heat addition stages</p></li>
<li><p>The thermal efficiency</p></li>
</ol>
</li>
</ol>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>State</p></th>
<th class="head"><p>p (kPa)</p></th>
<th class="head"><p>T (K)</p></th>
<th class="head text-right"><p>h (kJ/kg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td><p>100</p></td>
<td><p>300</p></td>
<td class="text-right"><p>300.19</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2</p></td>
<td><p>300</p></td>
<td><p>410.1</p></td>
<td class="text-right"><p>411.22</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3</p></td>
<td><p>300</p></td>
<td><p>300</p></td>
<td class="text-right"><p>300.19</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>4</p></td>
<td><p>1200</p></td>
<td><p>444.8</p></td>
<td class="text-right"><p>446.50</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5</p></td>
<td><p>1200</p></td>
<td><p>1111</p></td>
<td class="text-right"><p>1173.84</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>6</p></td>
<td><p>1200</p></td>
<td><p>1450</p></td>
<td class="text-right"><p>1575.57</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>7</p></td>
<td><p>300</p></td>
<td><p>1034.3</p></td>
<td class="text-right"><p>1085.31</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>8</p></td>
<td><p>300</p></td>
<td><p>1450</p></td>
<td class="text-right"><p>1575.57</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>9</p></td>
<td><p>100</p></td>
<td><p>1111</p></td>
<td class="text-right"><p>1173.84</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>10</p></td>
<td><p>100</p></td>
<td><p>444.8</p></td>
<td class="text-right"><p>446.50</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic simple" start="4">
<li><p>Consider an ideal gas-turbine cycle with two stages of compression and two stages of expansion. The pressure ratio across each stage of the compressor and turbine is 3. The air enters each stage of the compressor at 300 K and each stage of the turbine at 1200 K. Determine the thermal efficiency of the cycle, assuming (a) no regenerator is used and (b) a regenerator with 75 percent effectiveness is used. Use variable specific heats.</p></li>
<li><p>Air at ambient conditions is compressed with a compression ratio of <em><em>r</em></em> = 12 in an ideal Otto cycle. 700 kJ/kg of is added during the constant volume process.</p>
<ol class="arabic simple">
<li><p>What is the net specific work (<em><em>w<sub>net</sub></em></em>) of the cycle?</p></li>
<li><p>What is the thermal efficiency (<em><em>n<sub>th,otto</sub></em></em>) of this process?</p></li>
<li><p>What is the thermal efficiency (<em><em>n<sub>th</sub></em></em>) not assuming constant specific heats?</p></li>
</ol>
</li>
<li><p>An ideal Otto cycle has a compresion ratio of 10. The air is at <em><em>P</em></em> = 120 kPa and <em><em>T</em></em> = 300 K before compression and reaches <em><em>P</em></em> = 4.5 MPa and <em><em>T</em></em> = 1500 K after heat addition.</p>
<ol class="arabic simple">
<li><p>What is the specific heat addition (<em><em>q</em></em>) to the system?</p></li>
<li><p>What is the thermal efficiency of the cycle?</p></li>
</ol>
</li>
<li><p>An ideal Diesel cycle has a cutoff ratio of 3 and a compression ratio of 16. The air is at ambient conditions prior to compression.</p>
<ol class="arabic simple">
<li><p>What is the heat addition (<em><em>q</em></em>) to the system?</p></li>
<li><p>What is the thermal efficiency of the cycle?</p></li>
</ol>
</li>
<li><p>Air in an ideal diesel cycle is at <em><em>P</em></em> = 4 MPa and <em><em>T</em></em> = 1500 K after constant pressure heat addition. The cutoff ratio is 1.7 and the compression ration is 18.</p>
<ol class="arabic simple">
<li><p>What is the heat addition (<em><em>q</em></em>) to the system?</p></li>
<li><p>What is the net specific work (<em><em>w<sub>net</sub></em></em>) in the cycle?</p></li>
<li><p>What is the thermal efficiency (<em><em>n<sub>th</sub></em></em>) of the cycle?</p></li>
</ol>
</li>
<li><p>A power plant uses an ideal brayton cycle with a pressure ratio of 10. The gas enters the compressor at ambient conditions and enters the turbine at <em><em>T</em></em> 1500 K.</p>
<ol class="arabic simple">
<li><p>What is the heat addition to the system?</p></li>
<li><p>What is the thermal efficiency of the cycle?</p></li>
<li><p>If the net power is <em><em>P</em></em> = 1 MJ, what is the mass flowrate (<em><em>m</em></em>)?</p></li>
</ol>
</li>
</ol>
<p><a class="reference internal" href="Exercise_Solutions/Exercise%208.html#exercise8solutions"><span class="std std-numref">Section 11.8</span></a> <a class="reference internal" href="Exercise_Solutions/Exercise%208.html#exercise8solutions"><span class="std std-ref">Exercise 8 Solutions</span></a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Entropy%20Change%20of%20Real%20Processes%20v2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Entropy Change of Real and Idealized Processes</p>
      </div>
    </a>
    <a class="right-next"
       href="Exercise%20Solutions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">11. </span>Exercise Solutions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brayton-power-cycle">10.1. Brayton Power Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#idealbrayton">10.1.1. Ideal Brayton Power Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-brayton-cycle">10.1.1.1. Example - Analysis of an Ideal Brayton Cycle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brayton-power-cycle-with-intercooling-reheating-and-regeneration">10.2. Brayton Power Cycle with Intercooling, Reheating and Regeneration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intercooling">10.2.1. Intercooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reheating">10.2.2. Reheating</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regeneration">10.2.3. Regeneration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-intercooling-reheating-and-regeneration-brayton-cycle">10.2.3.1. Example - Analysis of an Intercooling, Reheating and Regeneration Brayton Cycle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closed-system-power-cycles">10.3. Closed-System Power Cycles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otto-cycle">10.3.1. Otto Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-otto-cycle">10.3.1.1. Example - Analysis of an Ideal Otto Cycle</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diesel-cycle">10.3.2. Diesel Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-diesel-cycle">10.3.2.1. Example - Analysis of an Ideal Diesel Cycle</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#programming-example-plotting-analysis-of-an-ideal-diesel-cycle">10.3.2.2. Programming Example - Plotting “Analysis of an Ideal Diesel Cycle”</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stirling-cycle">10.3.3. Stirling Cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis-of-an-ideal-stirling-cycle">10.3.3.1. Example - Analysis of an Ideal Stirling Cycle</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ericsson-cycle">10.3.4. Ericsson Cycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">10.3.5. Exercise 8</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonathan R. Scheffe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>